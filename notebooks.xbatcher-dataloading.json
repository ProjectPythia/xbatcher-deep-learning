{"version":2,"kind":"Notebook","sha256":"311a695ca202d786ffdcffae68a925e9c9a145eb8f7746514b359b50cda8414a","slug":"notebooks.xbatcher-dataloading","location":"/notebooks/xbatcher_dataloading.ipynb","dependencies":[],"frontmatter":{"title":"Dataloading from Xarray Datasets","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Keenan Ganz, Nabin Kalauni, and The Project Pythia Community","given":"and The Project Pythia Community","family":"Keenan Ganz","suffix":"Nabin Kalauni"},"name":"Keenan Ganz, Nabin Kalauni, and The Project Pythia Community","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/xbatcher-deep-learning","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/xbatcher-deep-learning/blob/main/notebooks/xbatcher_dataloading.ipynb","exports":[{"format":"ipynb","filename":"xbatcher_dataloading.ipynb","url":"/xbatcher-deep-learning/build/xbatcher_dataloading-a6fe41123d0ed8c7b05a8f21091dc224.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Working with large, multi-dimensional datasets, common in fields like climate science and oceanography, presents a significant challenge when preparing data for machine learning models. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gAr38Foasg"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pV6V89sWHl"},{"type":"text","value":" library is designed to simplify this crucial preprocessing step.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MayZbY2gGF"}],"key":"JGTExL5zvd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"S6lJQJD7zm"},{"type":"text","value":" is a Python package that facilitates the generation of data batches from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sHx1knqkT1"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vtQzZd1auJ"},{"type":"text","value":" objects for machine learning. It serves as a bridge between the labeled, multi-dimensional data structures of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WsIDMshCeE"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nEoLXw7xYZ"},{"type":"text","value":" and the tensor-based inputs required by deep learning frameworks such as PyTorch and TensorFlow.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b4jGks0n1p"}],"key":"IjhKeg1aLW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This guide provides an introduction to the fundamentals of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s51b6Q3XIx"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LnNsZPjVvl"},{"type":"text","value":". We will cover how to create a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VeFRn8VtWc"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LWfltWb1pw"},{"type":"text","value":", customize it for specific needs, and prepare the resulting data for integration with a PyTorch model.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"w610NYVj2f"}],"key":"OIJdZs6iM8"}],"key":"sjdEHTGbfD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hcIpZE4Hc7"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"S5GGtsFyDG"}],"key":"x3Ar6ljNVn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import xarray as xr\nimport numpy as np\nimport torch\nimport xbatcher\nfrom xbatcher.loaders.torch import MapDataset, IterableDataset","key":"yIZSIBw53Z"},{"type":"output","id":"vkxmihlHldCMl3tD-3vX3","data":[],"key":"dSloLctczV"}],"key":"rnHAVDow2S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Creating a Sample Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GEa79BqwKV"}],"identifier":"creating-a-sample-dataset","label":"Creating a Sample Dataset","html_id":"creating-a-sample-dataset","implicit":true,"key":"m6wWCXQtmN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To begin, we will create a sample ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JhBFy2e3VA"},{"type":"inlineCode","value":"xarray.Dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p4ffaUjvT5"},{"type":"text","value":". This allows us to focus on the mechanics of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JdFbb2xYXp"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GULUPH6LNn"},{"type":"text","value":" without the overhead of a specific real-world dataset. This sample can be replaced by any ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wFaMO0cdaM"},{"type":"inlineCode","value":"xarray.Dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FrVvB4oWFd"},{"type":"text","value":" loaded from a file (e.g., NetCDF, Zarr).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rQONVOGh5l"}],"key":"BD3097QrEG"}],"key":"h8kQfPNT8s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds = xr.Dataset(\n    {\n        \"temperature\": ((\"x\", \"y\", \"time\"), np.random.rand(100, 100, 50)),\n        \"precipitation\": ((\"x\", \"y\", \"time\"), np.random.rand(100, 100, 50)),\n    },\n    coords={\n        \"x\": np.arange(100),\n        \"y\": np.arange(100),\n        \"time\": np.arange(50),\n    },\n)\nds","key":"ofwQHVIVzN"},{"type":"output","id":"-8fikUlG0EiVVttURD_UJ","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 8MB\nDimensions:        (x: 100, y: 100, time: 50)\nCoordinates:\n  * x              (x) int64 800B 0 1 2 3 4 5 6 7 8 ... 92 93 94 95 96 97 98 99\n  * y              (y) int64 800B 0 1 2 3 4 5 6 7 8 ... 92 93 94 95 96 97 98 99\n  * time           (time) int64 400B 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49\nData variables:\n    temperature    (x, y, time) float64 4MB 0.02306 0.1631 ... 0.4373 0.5088\n    precipitation  (x, y, time) float64 4MB 0.2303 0.236 ... 0.6301 0.9083","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 8MB\nDimensions:        (x: 100, y: 100, time: 50)\nCoordinates:\n  * x              (x) int64 800B 0 1 2 3 4 5 6 7 8 ... 92 93 94 95 96 97 98 99\n  * y              (y) int64 800B 0 1 2 3 4 5 6 7 8 ... 92 93 94 95 96 97 98 99\n  * time           (time) int64 400B 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49\nData variables:\n    temperature    (x, y, time) float64 4MB 0.02306 0.1631 ... 0.4373 0.5088\n    precipitation  (x, y, time) float64 4MB 0.2303 0.236 ... 0.6301 0.9083</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e2ac9e84-1904-47c5-85dc-2d0c990ebe9b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e2ac9e84-1904-47c5-85dc-2d0c990ebe9b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>x</span>: 100</li><li><span class='xr-has-index'>y</span>: 100</li><li><span class='xr-has-index'>time</span>: 50</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-983b804b-0fb1-49d0-b0a3-063a76bc2c0e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-983b804b-0fb1-49d0-b0a3-063a76bc2c0e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 94 95 96 97 98 99</div><input id='attrs-85ee18ae-365f-456d-90f3-52f9915801ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-85ee18ae-365f-456d-90f3-52f9915801ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ba786d3-5b25-4b31-8f01-54ed361c8dda' class='xr-var-data-in' type='checkbox'><label for='data-5ba786d3-5b25-4b31-8f01-54ed361c8dda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,\n       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,\n       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,\n       90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 94 95 96 97 98 99</div><input id='attrs-cfbbda7d-dbc4-4c2b-b706-3e059b24b48e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cfbbda7d-dbc4-4c2b-b706-3e059b24b48e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c29e7d42-c546-46ac-9632-b1f1318d6c18' class='xr-var-data-in' type='checkbox'><label for='data-c29e7d42-c546-46ac-9632-b1f1318d6c18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,\n       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,\n       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,\n       90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-dfa21b5c-ba94-4057-8cf3-330b1e8d4007' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dfa21b5c-ba94-4057-8cf3-330b1e8d4007' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2917d64c-721a-4073-a654-80953e28cb8f' class='xr-var-data-in' type='checkbox'><label for='data-2917d64c-721a-4073-a654-80953e28cb8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-21c2b402-2baa-4af0-b970-fcf9e6f0aec8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-21c2b402-2baa-4af0-b970-fcf9e6f0aec8' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02306 0.1631 ... 0.4373 0.5088</div><input id='attrs-040673ce-8166-48b1-86c0-4bd2fef51b3d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-040673ce-8166-48b1-86c0-4bd2fef51b3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e23bb57-d692-44a8-bd70-87e488569b8c' class='xr-var-data-in' type='checkbox'><label for='data-4e23bb57-d692-44a8-bd70-87e488569b8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[2.30596257e-02, 1.63128471e-01, 6.43043414e-01, ...,\n         5.83720698e-01, 7.30209341e-01, 9.38737822e-02],\n        [5.71698268e-02, 1.82801725e-01, 2.91110309e-01, ...,\n         6.88045612e-01, 1.62623600e-01, 7.64661184e-01],\n        [9.05538406e-01, 7.37975067e-01, 1.75864098e-01, ...,\n         2.36476229e-01, 7.44213425e-01, 7.69282991e-01],\n        ...,\n        [4.68877810e-01, 7.94889435e-01, 6.57673709e-01, ...,\n         8.42018590e-01, 4.72637745e-01, 3.93079999e-01],\n        [2.71534473e-01, 2.79713395e-01, 8.62869753e-01, ...,\n         1.87917805e-01, 3.58250852e-01, 2.91988960e-02],\n        [6.83087772e-01, 8.00407289e-01, 1.20351868e-01, ...,\n         9.86543958e-03, 1.45723158e-02, 7.21367183e-01]],\n\n       [[5.46951281e-01, 6.15827816e-01, 2.65300862e-01, ...,\n         9.76243888e-01, 6.70099307e-01, 3.07607405e-01],\n        [9.24828599e-01, 3.46366303e-01, 2.37445800e-01, ...,\n         7.31404966e-01, 7.82694913e-01, 3.93275404e-01],\n        [2.99552759e-01, 7.36940818e-01, 8.33635803e-01, ...,\n         5.38532614e-01, 7.23853545e-01, 9.93161340e-01],\n...\n         8.27697691e-01, 3.18858684e-01, 6.57356379e-01],\n        [7.40145841e-01, 4.98967483e-01, 5.21054039e-01, ...,\n         1.08178914e-01, 3.24026229e-01, 3.74879117e-03],\n        [4.14899174e-01, 7.43079357e-01, 4.18970312e-01, ...,\n         6.83321362e-01, 2.80205048e-02, 4.92598591e-02]],\n\n       [[7.61333152e-01, 3.21707461e-01, 1.31835666e-01, ...,\n         6.46712724e-02, 9.02312440e-01, 9.57519039e-01],\n        [3.59052608e-03, 5.11345964e-01, 2.73291882e-01, ...,\n         3.42043583e-01, 9.45170875e-01, 8.74722362e-01],\n        [1.85868729e-02, 9.00805205e-01, 8.52028937e-01, ...,\n         4.44973738e-01, 1.59842638e-01, 1.82820381e-01],\n        ...,\n        [8.39440015e-02, 5.33958872e-01, 4.89926096e-01, ...,\n         9.37736318e-01, 3.41245347e-01, 2.82312696e-01],\n        [7.61699738e-02, 2.80002432e-01, 2.17423881e-03, ...,\n         1.21507318e-01, 4.89128487e-01, 6.05444290e-01],\n        [7.12885111e-01, 9.26360747e-01, 5.82622276e-02, ...,\n         6.75983373e-02, 4.37315706e-01, 5.08778361e-01]]],\n      shape=(100, 100, 50))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitation</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2303 0.236 ... 0.6301 0.9083</div><input id='attrs-70c90932-ecee-4cbc-b73e-bf8ac53247ab' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70c90932-ecee-4cbc-b73e-bf8ac53247ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57b5088b-debe-4842-a61c-e3930e79fbf0' class='xr-var-data-in' type='checkbox'><label for='data-57b5088b-debe-4842-a61c-e3930e79fbf0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[2.30265505e-01, 2.35968075e-01, 7.94179742e-01, ...,\n         7.88168725e-01, 6.89852205e-01, 9.80634838e-01],\n        [3.60626383e-01, 6.27130308e-01, 3.65124720e-01, ...,\n         2.90689311e-01, 3.47175561e-01, 6.08226827e-01],\n        [6.16485066e-01, 4.52411300e-01, 4.56802400e-01, ...,\n         8.61403826e-01, 9.22971335e-01, 5.93009864e-01],\n        ...,\n        [9.27228922e-01, 2.09431166e-01, 8.23773229e-01, ...,\n         2.47131429e-01, 6.86373138e-02, 7.26573512e-01],\n        [9.86213855e-02, 2.67477965e-01, 8.96108175e-01, ...,\n         1.97158662e-01, 2.00294665e-01, 5.30448366e-01],\n        [5.16888435e-01, 5.80762935e-01, 5.89113763e-01, ...,\n         3.94360286e-01, 2.59678511e-01, 1.76416743e-01]],\n\n       [[6.29487951e-01, 5.59868186e-02, 3.04321193e-01, ...,\n         9.87493796e-01, 4.13892313e-01, 5.38811014e-01],\n        [3.59284452e-02, 1.78482387e-01, 1.08409045e-02, ...,\n         3.89032954e-01, 5.39829303e-01, 9.85367999e-01],\n        [5.46959760e-01, 2.15901447e-01, 6.39737899e-01, ...,\n         4.63651184e-01, 4.93686882e-01, 7.87044739e-01],\n...\n         8.67155191e-01, 6.53181444e-01, 8.19453309e-01],\n        [9.19680956e-01, 9.23658805e-01, 4.27889746e-01, ...,\n         7.69155372e-01, 6.48233021e-01, 6.33810399e-01],\n        [4.12479705e-01, 7.77768351e-01, 5.03284611e-01, ...,\n         6.91142837e-01, 4.73016510e-01, 8.25224994e-02]],\n\n       [[1.38390450e-01, 8.30767396e-01, 2.93435430e-01, ...,\n         8.64402739e-01, 8.03984748e-01, 3.41625619e-01],\n        [5.53299780e-01, 4.78691110e-01, 4.06454524e-01, ...,\n         3.92231915e-01, 2.95576662e-01, 1.66091939e-01],\n        [9.76297557e-01, 6.03680711e-01, 6.93824387e-01, ...,\n         2.65832721e-01, 1.39769749e-01, 1.12570921e-01],\n        ...,\n        [3.98187560e-01, 7.34767017e-02, 5.51312909e-01, ...,\n         8.30673669e-01, 9.23833258e-01, 8.22463423e-01],\n        [9.49410608e-01, 4.05259691e-01, 1.20779119e-01, ...,\n         7.19877000e-01, 1.55759704e-01, 2.46797244e-01],\n        [8.55913654e-01, 4.51803313e-01, 8.97614851e-01, ...,\n         5.87193584e-01, 6.30077715e-01, 9.08251393e-01]]],\n      shape=(100, 100, 50))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6ab58829-79c8-4637-bb76-dee6e228da4c' class='xr-section-summary-in' type='checkbox'  ><label for='section-6ab58829-79c8-4637-bb76-dee6e228da4c' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a56cdb92-09f4-4e8d-b983-da833b948d87' class='xr-index-data-in' type='checkbox'/><label for='index-a56cdb92-09f4-4e8d-b983-da833b948d87' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,\n       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,\n       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,\n       90, 91, 92, 93, 94, 95, 96, 97, 98, 99],\n      dtype=&#x27;int64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8eed2937-69d2-437e-b081-3c98fc699427' class='xr-index-data-in' type='checkbox'/><label for='index-8eed2937-69d2-437e-b081-3c98fc699427' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,\n       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,\n       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,\n       90, 91, 92, 93, 94, 95, 96, 97, 98, 99],\n      dtype=&#x27;int64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b33a2c8b-6971-425c-a927-a43745fe864b' class='xr-index-data-in' type='checkbox'/><label for='index-b33a2c8b-6971-425c-a927-a43745fe864b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49],\n      dtype=&#x27;int64&#x27;, name=&#x27;time&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9fe48aba-c6ae-4439-8eed-c2315a02a0ce' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9fe48aba-c6ae-4439-8eed-c2315a02a0ce' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"sXd01V3NOn"}],"key":"bdXqT9P44i"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The dataset contains two variables, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Oq1P87iUdK"},{"type":"inlineCode","value":"temperature","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pG7kcFtg5v"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VsTOLAWAGg"},{"type":"inlineCode","value":"precipitation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V89PmSv52I"},{"type":"text","value":", and three dimensions: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QBbxqcxst6"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lAIUpraIYw"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mpcKJYsm6X"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BGrJ4S9pk7"},{"type":"text","value":", and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nGAAxaCdNu"},{"type":"inlineCode","value":"time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UwCUNNMig4"},{"type":"text","value":". We will now use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RtZUNbg5iC"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f7bSHzY5VB"},{"type":"text","value":" to generate batches from this dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P5kg0JfhCt"}],"key":"plefZmP0FW"}],"key":"Wp2oyT0tf8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AIZvuWvxGw"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GQTC8t5ZFt"}],"identifier":"the-batchgenerator","label":"The BatchGenerator","html_id":"the-batchgenerator","implicit":true,"key":"KLCD4yptIh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vLvUCVG0uR"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"csyz2gk68Z"},{"type":"text","value":" is the core component of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YpZARpXLo5"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bu4YWTK2fe"},{"type":"text","value":". It is a Python generator that yields batches of data from an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h3Vv2doyqb"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RQK6AImqb6"},{"type":"text","value":" object.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gX450ejPpJ"}],"key":"yF9GGwE9Si"}],"key":"FVykZSUV6r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bgen = xbatcher.BatchGenerator(ds, input_dims={\"x\": 10, \"y\": 10})","key":"byezGII8FV"},{"type":"output","id":"k1p2TTK0QPa4EXAdymW7w","data":[],"key":"gPDn89MZrP"}],"key":"hoJhS8SysR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JzjVRXeMv5"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b6HQxZTuCq"},{"type":"text","value":" is initialized with the dataset and the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wOsB4XqR4O"},{"type":"inlineCode","value":"input_dims","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"exP0m0SCAo"},{"type":"text","value":" parameter. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hnUffv6B1m"},{"type":"inlineCode","value":"input_dims","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wBhJK3DPlJ"},{"type":"text","value":" specifies the size of the batches along each dimension. In this case, we are creating batches of size 10x10 along the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dHcFWi2yZ0"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gyynh50jYq"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kZNBXwHp2d"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kq6HT2upkB"},{"type":"text","value":" dimensions. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KEsTcfPSC5"},{"type":"inlineCode","value":"time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s8B1Qk277A"},{"type":"text","value":" dimension is not specified, so ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A9qWyVc3zp"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YVszbCT59R"},{"type":"text","value":" will yield batches that include all time steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dIRZSUxzmW"}],"key":"jDcYKHwigi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s inspect the first batch generated.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uE9hxkGT9Z"}],"key":"DBguUFZfa5"}],"key":"QX9q9L3BCk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"first_batch = next(iter(bgen))\nfirst_batch","key":"jN2xXMylXE"},{"type":"output","id":"V1c2QqM-3ZfMQTphYgFaR","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 81kB\nDimensions:        (x: 10, y: 10, time: 50)\nCoordinates:\n  * x              (x) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * y              (y) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * time           (time) int64 400B 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49\nData variables:\n    temperature    (x, y, time) float64 40kB 0.02306 0.1631 ... 0.7375 0.2898\n    precipitation  (x, y, time) float64 40kB 0.2303 0.236 ... 0.5669 0.384","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 81kB\nDimensions:        (x: 10, y: 10, time: 50)\nCoordinates:\n  * x              (x) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * y              (y) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * time           (time) int64 400B 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49\nData variables:\n    temperature    (x, y, time) float64 40kB 0.02306 0.1631 ... 0.7375 0.2898\n    precipitation  (x, y, time) float64 40kB 0.2303 0.236 ... 0.5669 0.384</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1e124c85-540a-4b49-ac58-3d656360538b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1e124c85-540a-4b49-ac58-3d656360538b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>x</span>: 10</li><li><span class='xr-has-index'>y</span>: 10</li><li><span class='xr-has-index'>time</span>: 50</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-27e22f62-374d-4ef4-b0fd-bf19fc6571a9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-27e22f62-374d-4ef4-b0fd-bf19fc6571a9' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-7a159174-7ad5-405a-919f-b8a48888b265' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7a159174-7ad5-405a-919f-b8a48888b265' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d28d18c7-1f6e-4c92-ba08-083f6af74aeb' class='xr-var-data-in' type='checkbox'><label for='data-d28d18c7-1f6e-4c92-ba08-083f6af74aeb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-ac8217fe-f184-4dbc-a2e7-f0f94f6b5a8c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ac8217fe-f184-4dbc-a2e7-f0f94f6b5a8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ab697ef-44df-450c-af8d-5306e3fe8ee3' class='xr-var-data-in' type='checkbox'><label for='data-2ab697ef-44df-450c-af8d-5306e3fe8ee3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-ac709e43-f21a-4e66-b879-702570290843' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ac709e43-f21a-4e66-b879-702570290843' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f907d7c-45de-4e66-8e8c-fc2aa851e831' class='xr-var-data-in' type='checkbox'><label for='data-3f907d7c-45de-4e66-8e8c-fc2aa851e831' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2e5d4e88-818a-43a4-abb1-505f8c97fa42' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2e5d4e88-818a-43a4-abb1-505f8c97fa42' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02306 0.1631 ... 0.7375 0.2898</div><input id='attrs-a97885c9-4bf2-49c9-873c-358f3f4eb257' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a97885c9-4bf2-49c9-873c-358f3f4eb257' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6effebf-3d00-4a88-aeac-d76ec4ae9c96' class='xr-var-data-in' type='checkbox'><label for='data-a6effebf-3d00-4a88-aeac-d76ec4ae9c96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.02305963, 0.16312847, 0.64304341, ..., 0.5837207 ,\n         0.73020934, 0.09387378],\n        [0.05716983, 0.18280173, 0.29111031, ..., 0.68804561,\n         0.1626236 , 0.76466118],\n        [0.90553841, 0.73797507, 0.1758641 , ..., 0.23647623,\n         0.74421343, 0.76928299],\n        ...,\n        [0.73292511, 0.05015898, 0.50646932, ..., 0.19090983,\n         0.46988762, 0.3525439 ],\n        [0.11605766, 0.25502384, 0.87959282, ..., 0.11740596,\n         0.76348171, 0.68502549],\n        [0.14560987, 0.45045148, 0.15201949, ..., 0.13978188,\n         0.51839311, 0.68652119]],\n\n       [[0.54695128, 0.61582782, 0.26530086, ..., 0.97624389,\n         0.67009931, 0.3076074 ],\n        [0.9248286 , 0.3463663 , 0.2374458 , ..., 0.73140497,\n         0.78269491, 0.3932754 ],\n        [0.29955276, 0.73694082, 0.8336358 , ..., 0.53853261,\n         0.72385354, 0.99316134],\n...\n        [0.99386526, 0.06619639, 0.81132192, ..., 0.42110763,\n         0.36942115, 0.97946132],\n        [0.41317357, 0.80547688, 0.49235297, ..., 0.59252818,\n         0.64595075, 0.52888822],\n        [0.70002272, 0.54479537, 0.95372704, ..., 0.29970919,\n         0.79862987, 0.14943898]],\n\n       [[0.68869786, 0.20173698, 0.32048958, ..., 0.78833284,\n         0.65635123, 0.50328276],\n        [0.03838682, 0.51941355, 0.3446724 , ..., 0.68507342,\n         0.38366802, 0.97015857],\n        [0.57243082, 0.95305185, 0.1244058 , ..., 0.60737465,\n         0.21851243, 0.19223106],\n        ...,\n        [0.81371014, 0.38848293, 0.70617625, ..., 0.91635451,\n         0.94632724, 0.89132645],\n        [0.58606913, 0.40412142, 0.61314401, ..., 0.99884572,\n         0.80265149, 0.05651923],\n        [0.62766615, 0.29120839, 0.55083271, ..., 0.77381805,\n         0.73753095, 0.28982351]]], shape=(10, 10, 50))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitation</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2303 0.236 ... 0.5669 0.384</div><input id='attrs-ffbc065d-2c6f-4369-8567-57a2f7aa4255' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ffbc065d-2c6f-4369-8567-57a2f7aa4255' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51215048-9eb5-40cf-92e1-e99071df52a6' class='xr-var-data-in' type='checkbox'><label for='data-51215048-9eb5-40cf-92e1-e99071df52a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[2.30265505e-01, 2.35968075e-01, 7.94179742e-01, ...,\n         7.88168725e-01, 6.89852205e-01, 9.80634838e-01],\n        [3.60626383e-01, 6.27130308e-01, 3.65124720e-01, ...,\n         2.90689311e-01, 3.47175561e-01, 6.08226827e-01],\n        [6.16485066e-01, 4.52411300e-01, 4.56802400e-01, ...,\n         8.61403826e-01, 9.22971335e-01, 5.93009864e-01],\n        ...,\n        [9.41848830e-01, 6.00302297e-01, 5.64749093e-01, ...,\n         8.30914481e-02, 5.61943549e-01, 6.30445600e-01],\n        [8.87129436e-01, 7.24070188e-01, 6.31230618e-01, ...,\n         9.23195114e-01, 2.66919194e-01, 9.62657436e-01],\n        [5.36515832e-01, 2.96143332e-01, 6.69783769e-01, ...,\n         7.70800284e-01, 5.18913829e-01, 4.22818548e-01]],\n\n       [[6.29487951e-01, 5.59868186e-02, 3.04321193e-01, ...,\n         9.87493796e-01, 4.13892313e-01, 5.38811014e-01],\n        [3.59284452e-02, 1.78482387e-01, 1.08409045e-02, ...,\n         3.89032954e-01, 5.39829303e-01, 9.85367999e-01],\n        [5.46959760e-01, 2.15901447e-01, 6.39737899e-01, ...,\n         4.63651184e-01, 4.93686882e-01, 7.87044739e-01],\n...\n         3.91071868e-01, 2.38998392e-01, 6.85227892e-01],\n        [8.00759161e-02, 3.67251351e-01, 6.01564314e-01, ...,\n         1.13473083e-01, 7.43872083e-01, 3.38161957e-01],\n        [6.44364325e-01, 5.70376974e-01, 2.71853259e-01, ...,\n         2.98663286e-01, 7.33247262e-02, 7.90139761e-01]],\n\n       [[7.63037959e-01, 7.49720013e-01, 4.77614323e-01, ...,\n         5.25278618e-01, 1.94489886e-01, 7.30543159e-01],\n        [2.57580458e-01, 7.73815836e-02, 4.83860309e-02, ...,\n         9.40010235e-01, 5.36010613e-01, 3.48301189e-02],\n        [3.74252368e-01, 9.22980788e-01, 3.50305478e-01, ...,\n         6.68442508e-01, 6.01739655e-01, 4.33873891e-01],\n        ...,\n        [5.77723868e-01, 6.53661855e-01, 4.08079989e-01, ...,\n         4.68700126e-01, 8.81997333e-01, 3.63153286e-01],\n        [4.72607471e-01, 2.68365017e-01, 1.93011584e-01, ...,\n         2.63212823e-01, 3.76065991e-01, 9.36445793e-01],\n        [1.25019352e-01, 2.43232593e-01, 3.16218545e-02, ...,\n         1.50554320e-01, 5.66903288e-01, 3.84012968e-01]]],\n      shape=(10, 10, 50))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f85fa032-f079-4d45-9ad2-a297868532ce' class='xr-section-summary-in' type='checkbox'  ><label for='section-f85fa032-f079-4d45-9ad2-a297868532ce' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f3821870-f31f-4c84-bd6b-c5b199faaa1a' class='xr-index-data-in' type='checkbox'/><label for='index-f3821870-f31f-4c84-bd6b-c5b199faaa1a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ad0a19ed-3b90-4023-8d1b-73dab15de5a1' class='xr-index-data-in' type='checkbox'/><label for='index-ad0a19ed-3b90-4023-8d1b-73dab15de5a1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0d614135-70a8-4285-9f8a-c3c289a8c08c' class='xr-index-data-in' type='checkbox'/><label for='index-0d614135-70a8-4285-9f8a-c3c289a8c08c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49],\n      dtype=&#x27;int64&#x27;, name=&#x27;time&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f6e8fee5-cf4d-4ca9-954f-3584f83b679c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f6e8fee5-cf4d-4ca9-954f-3584f83b679c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"x25HDBoaTc"}],"key":"qihJ1x9BFM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The first batch has dimensions ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aIP2iNjAwV"},{"type":"inlineCode","value":"x=10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dpf5s98qIC"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fkgIK6SM8b"},{"type":"inlineCode","value":"y=10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sXBNN8cd6M"},{"type":"text","value":", and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B9yrOLVo5w"},{"type":"inlineCode","value":"time=50","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZEWJPPwqaP"},{"type":"text","value":", as expected. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xH4hwDiJnZ"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"krm04rvn0R"},{"type":"text","value":" will yield 100 batches in total (10 batches in the x-direction * 10 batches in the y-direction).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U5J5TbNvix"}],"key":"WGNLrxx4Br"}],"key":"LuAvGNiWtu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"The BatchGenerator contains {len(bgen)} batches.\")","key":"XtmKS7JsnI"},{"type":"output","id":"h1mkSxRSwZosmM96bYtEX","data":[{"output_type":"stream","name":"stdout","text":"The BatchGenerator contains 100 batches.\n"}],"key":"FG2vRy7IKS"}],"key":"i0PZDucKPV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overlapping Batches with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DGIeT6uetq"},{"type":"inlineCode","value":"input_overlap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h8MKkkMlC6"}],"identifier":"overlapping-batches-with-input-overlap","label":"Overlapping Batches with input_overlap","html_id":"overlapping-batches-with-input-overlap","implicit":true,"key":"l8oHkqCnCI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In many applications, it is useful to have overlapping batches to provide context from neighboring data points. The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lgq25UDS9u"},{"type":"inlineCode","value":"input_overlap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"suAJF6P1o6"},{"type":"text","value":" parameter allows for this.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Hd8VInEPqD"}],"key":"a2Zj1NIXgq"}],"key":"RzFyIecKI2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bgen_overlap = xbatcher.BatchGenerator(\n    ds, \n    input_dims={\"x\": 10, \"y\": 10}, \n    input_overlap={\"x\": 2, \"y\": 2}\n)\nfirst_batch_overlap = next(iter(bgen_overlap))\nfirst_batch_overlap","key":"pQIsm8Kr1b"},{"type":"output","id":"5T_k6Tl6NJpo5_8vRbrhI","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 81kB\nDimensions:        (x: 10, y: 10, time: 50)\nCoordinates:\n  * x              (x) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * y              (y) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * time           (time) int64 400B 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49\nData variables:\n    temperature    (x, y, time) float64 40kB 0.02306 0.1631 ... 0.7375 0.2898\n    precipitation  (x, y, time) float64 40kB 0.2303 0.236 ... 0.5669 0.384","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 81kB\nDimensions:        (x: 10, y: 10, time: 50)\nCoordinates:\n  * x              (x) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * y              (y) int64 80B 0 1 2 3 4 5 6 7 8 9\n  * time           (time) int64 400B 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49\nData variables:\n    temperature    (x, y, time) float64 40kB 0.02306 0.1631 ... 0.7375 0.2898\n    precipitation  (x, y, time) float64 40kB 0.2303 0.236 ... 0.5669 0.384</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-eaa113bf-96de-4def-9bf9-3ee7be7ca549' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eaa113bf-96de-4def-9bf9-3ee7be7ca549' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>x</span>: 10</li><li><span class='xr-has-index'>y</span>: 10</li><li><span class='xr-has-index'>time</span>: 50</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c49f6c9b-d61e-4c37-8869-b098b682fc33' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c49f6c9b-d61e-4c37-8869-b098b682fc33' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-9a8dc4c2-1d09-4b9c-9b86-7872f3aebaa8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a8dc4c2-1d09-4b9c-9b86-7872f3aebaa8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa6bdd13-f65f-4112-9a48-cd5f759b9c95' class='xr-var-data-in' type='checkbox'><label for='data-fa6bdd13-f65f-4112-9a48-cd5f759b9c95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-4db457c7-6a68-465f-b662-fc0fde76c29d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4db457c7-6a68-465f-b662-fc0fde76c29d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ea528a0-d61c-475b-8b8f-c56c4297fc65' class='xr-var-data-in' type='checkbox'><label for='data-6ea528a0-d61c-475b-8b8f-c56c4297fc65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-41ff2980-1d34-4ff7-b969-69a6f208e686' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-41ff2980-1d34-4ff7-b969-69a6f208e686' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41bb652e-eadc-4652-a503-76463a7b62b7' class='xr-var-data-in' type='checkbox'><label for='data-41bb652e-eadc-4652-a503-76463a7b62b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e692dcaf-62a1-4c79-963a-b9d4f2cf78f2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e692dcaf-62a1-4c79-963a-b9d4f2cf78f2' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02306 0.1631 ... 0.7375 0.2898</div><input id='attrs-0feeff9a-4b88-4a8b-9ce0-5ad2881c851a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0feeff9a-4b88-4a8b-9ce0-5ad2881c851a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a318c2bc-fbb3-4ef1-b9bc-fd84f12908bc' class='xr-var-data-in' type='checkbox'><label for='data-a318c2bc-fbb3-4ef1-b9bc-fd84f12908bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.02305963, 0.16312847, 0.64304341, ..., 0.5837207 ,\n         0.73020934, 0.09387378],\n        [0.05716983, 0.18280173, 0.29111031, ..., 0.68804561,\n         0.1626236 , 0.76466118],\n        [0.90553841, 0.73797507, 0.1758641 , ..., 0.23647623,\n         0.74421343, 0.76928299],\n        ...,\n        [0.73292511, 0.05015898, 0.50646932, ..., 0.19090983,\n         0.46988762, 0.3525439 ],\n        [0.11605766, 0.25502384, 0.87959282, ..., 0.11740596,\n         0.76348171, 0.68502549],\n        [0.14560987, 0.45045148, 0.15201949, ..., 0.13978188,\n         0.51839311, 0.68652119]],\n\n       [[0.54695128, 0.61582782, 0.26530086, ..., 0.97624389,\n         0.67009931, 0.3076074 ],\n        [0.9248286 , 0.3463663 , 0.2374458 , ..., 0.73140497,\n         0.78269491, 0.3932754 ],\n        [0.29955276, 0.73694082, 0.8336358 , ..., 0.53853261,\n         0.72385354, 0.99316134],\n...\n        [0.99386526, 0.06619639, 0.81132192, ..., 0.42110763,\n         0.36942115, 0.97946132],\n        [0.41317357, 0.80547688, 0.49235297, ..., 0.59252818,\n         0.64595075, 0.52888822],\n        [0.70002272, 0.54479537, 0.95372704, ..., 0.29970919,\n         0.79862987, 0.14943898]],\n\n       [[0.68869786, 0.20173698, 0.32048958, ..., 0.78833284,\n         0.65635123, 0.50328276],\n        [0.03838682, 0.51941355, 0.3446724 , ..., 0.68507342,\n         0.38366802, 0.97015857],\n        [0.57243082, 0.95305185, 0.1244058 , ..., 0.60737465,\n         0.21851243, 0.19223106],\n        ...,\n        [0.81371014, 0.38848293, 0.70617625, ..., 0.91635451,\n         0.94632724, 0.89132645],\n        [0.58606913, 0.40412142, 0.61314401, ..., 0.99884572,\n         0.80265149, 0.05651923],\n        [0.62766615, 0.29120839, 0.55083271, ..., 0.77381805,\n         0.73753095, 0.28982351]]], shape=(10, 10, 50))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitation</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2303 0.236 ... 0.5669 0.384</div><input id='attrs-beb4bc0a-c3ff-4126-b77e-ab8442e0bfe7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-beb4bc0a-c3ff-4126-b77e-ab8442e0bfe7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d39033c-6a63-4b9e-848f-1158b46025aa' class='xr-var-data-in' type='checkbox'><label for='data-8d39033c-6a63-4b9e-848f-1158b46025aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[2.30265505e-01, 2.35968075e-01, 7.94179742e-01, ...,\n         7.88168725e-01, 6.89852205e-01, 9.80634838e-01],\n        [3.60626383e-01, 6.27130308e-01, 3.65124720e-01, ...,\n         2.90689311e-01, 3.47175561e-01, 6.08226827e-01],\n        [6.16485066e-01, 4.52411300e-01, 4.56802400e-01, ...,\n         8.61403826e-01, 9.22971335e-01, 5.93009864e-01],\n        ...,\n        [9.41848830e-01, 6.00302297e-01, 5.64749093e-01, ...,\n         8.30914481e-02, 5.61943549e-01, 6.30445600e-01],\n        [8.87129436e-01, 7.24070188e-01, 6.31230618e-01, ...,\n         9.23195114e-01, 2.66919194e-01, 9.62657436e-01],\n        [5.36515832e-01, 2.96143332e-01, 6.69783769e-01, ...,\n         7.70800284e-01, 5.18913829e-01, 4.22818548e-01]],\n\n       [[6.29487951e-01, 5.59868186e-02, 3.04321193e-01, ...,\n         9.87493796e-01, 4.13892313e-01, 5.38811014e-01],\n        [3.59284452e-02, 1.78482387e-01, 1.08409045e-02, ...,\n         3.89032954e-01, 5.39829303e-01, 9.85367999e-01],\n        [5.46959760e-01, 2.15901447e-01, 6.39737899e-01, ...,\n         4.63651184e-01, 4.93686882e-01, 7.87044739e-01],\n...\n         3.91071868e-01, 2.38998392e-01, 6.85227892e-01],\n        [8.00759161e-02, 3.67251351e-01, 6.01564314e-01, ...,\n         1.13473083e-01, 7.43872083e-01, 3.38161957e-01],\n        [6.44364325e-01, 5.70376974e-01, 2.71853259e-01, ...,\n         2.98663286e-01, 7.33247262e-02, 7.90139761e-01]],\n\n       [[7.63037959e-01, 7.49720013e-01, 4.77614323e-01, ...,\n         5.25278618e-01, 1.94489886e-01, 7.30543159e-01],\n        [2.57580458e-01, 7.73815836e-02, 4.83860309e-02, ...,\n         9.40010235e-01, 5.36010613e-01, 3.48301189e-02],\n        [3.74252368e-01, 9.22980788e-01, 3.50305478e-01, ...,\n         6.68442508e-01, 6.01739655e-01, 4.33873891e-01],\n        ...,\n        [5.77723868e-01, 6.53661855e-01, 4.08079989e-01, ...,\n         4.68700126e-01, 8.81997333e-01, 3.63153286e-01],\n        [4.72607471e-01, 2.68365017e-01, 1.93011584e-01, ...,\n         2.63212823e-01, 3.76065991e-01, 9.36445793e-01],\n        [1.25019352e-01, 2.43232593e-01, 3.16218545e-02, ...,\n         1.50554320e-01, 5.66903288e-01, 3.84012968e-01]]],\n      shape=(10, 10, 50))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cc0d14f6-61f9-4e78-93ce-ea3dfe77d131' class='xr-section-summary-in' type='checkbox'  ><label for='section-cc0d14f6-61f9-4e78-93ce-ea3dfe77d131' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-58cc6ef6-7fde-4baf-9cb4-cd9ba6d6251b' class='xr-index-data-in' type='checkbox'/><label for='index-58cc6ef6-7fde-4baf-9cb4-cd9ba6d6251b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ecad2eb4-d333-486e-bdb5-cdcf32052c4d' class='xr-index-data-in' type='checkbox'/><label for='index-ecad2eb4-d333-486e-bdb5-cdcf32052c4d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e160972d-8a00-4e8c-b7ef-abb2658a016a' class='xr-index-data-in' type='checkbox'/><label for='index-e160972d-8a00-4e8c-b7ef-abb2658a016a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49],\n      dtype=&#x27;int64&#x27;, name=&#x27;time&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b2ca7b0-5c6a-4e3c-9c94-290a2df2cace' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6b2ca7b0-5c6a-4e3c-9c94-290a2df2cace' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"Db2DH29xZb"}],"key":"kx0B18FQTM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rCytS3oVqy"},{"type":"inlineCode","value":"input_overlap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wOytpkq7wy"},{"type":"text","value":" parameter specifies the number of elements to overlap between consecutive batches. The size of the batches themselves does not change. Let’s verify this by inspecting the coordinates of the first two batches.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kxNB9PfpUA"}],"key":"VDarmuyLrf"}],"key":"FX9T5m9P7q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"Batch 1 y-coords: {bgen_overlap[0].y.values}, Batch 1 x-coords: {bgen_overlap[0].x.values}\")\nprint(f\"Batch 2 y-coords: {bgen_overlap[1].y.values}, Batch 2 x-coords: {bgen_overlap[1].x.values}\")\nprint(f\"Batch 3 y-coords: {bgen_overlap[2].y.values}, Batch 3 x-coords: {bgen_overlap[2].x.values}\")\nprint(f\"Batch 13 y-coords: {bgen_overlap[12].y.values}, Batch 13 x-coords: {bgen_overlap[12].x.values}\")\nprint(f\"Batch 14 y-coords: {bgen_overlap[13].y.values}, Batch 11 x-coords: {bgen_overlap[13].x.values}\")","key":"JeQMR4hvTt"},{"type":"output","id":"YIn2mFYhImU3v9iiTtg_m","data":[{"output_type":"stream","name":"stdout","text":"Batch 1 y-coords: [0 1 2 3 4 5 6 7 8 9], Batch 1 x-coords: [0 1 2 3 4 5 6 7 8 9]\nBatch 2 y-coords: [ 8  9 10 11 12 13 14 15 16 17], Batch 2 x-coords: [0 1 2 3 4 5 6 7 8 9]\nBatch 3 y-coords: [16 17 18 19 20 21 22 23 24 25], Batch 3 x-coords: [0 1 2 3 4 5 6 7 8 9]\nBatch 13 y-coords: [0 1 2 3 4 5 6 7 8 9], Batch 13 x-coords: [ 8  9 10 11 12 13 14 15 16 17]\nBatch 14 y-coords: [ 8  9 10 11 12 13 14 15 16 17], Batch 11 x-coords: [ 8  9 10 11 12 13 14 15 16 17]\n"}],"key":"akTG0MqOpE"}],"key":"PSFLc2g6CD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, the second batch starts at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u5OiwNsk5y"},{"type":"inlineCode","value":"y=8","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iUPuGl3Vnj"},{"type":"text","value":", which is an overlap of 2 elements with the first batch, which ends at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AVORO821pa"},{"type":"inlineCode","value":"y=9","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XGnGO6ALjO"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bVUEclvnKR"}],"key":"UFUDYyrXf0"}],"key":"MvX5dfcAx7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Integration with PyTorch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rYU0E126DP"}],"identifier":"integration-with-pytorch","label":"Integration with PyTorch","html_id":"integration-with-pytorch","implicit":true,"key":"A92aEZdsGT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eWY6636SL8"},{"type":"text","value":" provides ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Mw1HP8J6FN"},{"type":"inlineCode","value":"MapDataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uv8SpHcJ3b"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"okcOfj2tCe"},{"type":"inlineCode","value":"IterableDataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eZVK9fhu3U"},{"type":"text","value":" to wrap the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Zp3MZ2yf8m"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Snr8DZ5Rwn"},{"type":"text","value":" for use with PyTorch.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g50GdpygXx"}],"key":"VHbUra30I3"}],"key":"LF07b1kW0v"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"MapDataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KgmMWobO7d"},{"type":"text","value":" vs. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VpQmDcr3b2"},{"type":"inlineCode","value":"IterableDataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cValKyouxP"}],"identifier":"mapdataset-vs-iterabledataset","label":"MapDataset vs. IterableDataset","html_id":"mapdataset-vs-iterabledataset","implicit":true,"key":"sSNkyZ46ZS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"MapDataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ElghtXmvox"},{"type":"text","value":": Implements ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JumBUlDTUf"},{"type":"inlineCode","value":"__getitem__","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XuRgawSCob"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lfyN5wgqox"},{"type":"inlineCode","value":"__len__","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o3xtDshwLf"},{"type":"text","value":", allowing for random access to data samples. This is the most common type of dataset in PyTorch.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dJNzPdUWr7"}],"key":"JD1rH6jQMF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"IterableDataset","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LsFfgSG9a3"},{"type":"text","value":": Implements ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dWLKW9WUlM"},{"type":"inlineCode","value":"__iter__","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HnnROugJ9c"},{"type":"text","value":", and is suitable for very large datasets that may not fit into memory, as it streams data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"I5b62lUjSm"}],"key":"qp9LzDInNV"}],"key":"acwOiYYBfX"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We will use ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ILylFzOrn4"},{"type":"inlineCode","value":"MapDataset","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HsjSnojoPX"},{"type":"text","value":" for this example.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"q4XrBFGlUx"}],"key":"GtC53nkA7A"}],"key":"D1guGkzv3a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bgen[0].temperature.shape\nbgen[0].precipitation.shape","key":"jeG5fTIPkl"},{"type":"output","id":"dKXVvVAL9cvBeVyS4JkMu","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"(10, 10, 50)","content_type":"text/plain"}}}],"key":"bMDBEfVwNA"}],"key":"HDvA0ZyCzo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def patch_to_tensor(patch):\n    temp_patch = torch.tensor(patch.temperature.data)\n    prcp_patch = torch.tensor(patch.precipitation.data)\n    stacked_patch = torch.stack((temp_patch, prcp_patch), dim=0)\n    patch = stacked_patch\n    patch = torch.nan_to_num(patch)\n    # patch = torch.unsqueeze(patch, 0)\n    patch = patch.float()\n    return patch\n\nmap_ds = MapDataset(bgen, transform=patch_to_tensor)","key":"pUTo8zbUDf"},{"type":"output","id":"PWg2anl4LLPfOm0Dh0eKw","data":[],"key":"vEkgwEaHTl"}],"key":"ZDqQbKrQt5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h29GANroLp"},{"type":"inlineCode","value":"MapDataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pqKorRFGIe"},{"type":"text","value":" can then be used with a PyTorch ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"STqqytpE8z"},{"type":"inlineCode","value":"DataLoader","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WeSDbUCtj8"},{"type":"text","value":", which provides utilities for shuffling, batching, and multiprocessing.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nzScFX7LU7"}],"key":"BgKsnNPZMY"}],"key":"XdvamKB3xx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dataloader = torch.utils.data.DataLoader(map_ds, batch_size=4)","key":"VyhBAgrtQ7"},{"type":"output","id":"IDYdO9vdhAACPYZ42Ukcl","data":[],"key":"Ao5xHgRMgN"}],"key":"L9HLGJWrbA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inspecting a batch from the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AeCDGnGnGP"},{"type":"inlineCode","value":"DataLoader","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o1K3RDbJrZ"},{"type":"text","value":" reveals a batch of PyTorch tensors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sl8ZMtbVne"}],"key":"SIBSZNJq4N"}],"key":"rSOZFk2xyD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"torch_batch = next(iter(dataloader))\ntorch_batch.shape","key":"KzCvPGFfJs"},{"type":"output","id":"fwJzdN7Ah7iVJMuiMXMTD","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"torch.Size([4, 2, 10, 10, 50])","content_type":"text/plain"}}}],"key":"Nq5ApZ9MT2"}],"key":"m5uZBvK4cI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wfJ1wA2hAY"},{"type":"inlineCode","value":"DataLoader","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fAv8aTSMxL"},{"type":"text","value":" has stacked 4 of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cV0OG3xpR4"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m7yhAzsBYA"},{"type":"text","value":" batches, creating a new ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zGxemwl6Oa"},{"type":"inlineCode","value":"batch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o2Lw7HXEP6"},{"type":"text","value":" dimension of size 4. The data is now ready for use in a PyTorch model.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M5FhiPnjdU"}],"key":"AtxDQHIuZZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the next notebook, we will explore how to reconstruct an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E4Ing9N2N8"},{"type":"inlineCode","value":"xarray.Dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CC9FZsaMvH"},{"type":"text","value":" from a model’s output.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Bgdbs29Q5o"}],"key":"Cv5b42RbUM"}],"key":"WZNFFZCSoQ"}],"key":"NUCGQz8rYv"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"How to Cite This Cookbook","url":"/notebooks/how-to-cite","group":"Preamble"},"next":{"title":"Reconstructing Xarray Datasets from Model Outputs","url":"/notebooks/xbatcher-reconstruction","group":"Xbatcher fundamentals"}}},"domain":"http://localhost:3000"}