{"version":2,"kind":"Notebook","sha256":"8eed5c50651036b25abcb8b01ed4542324037508b33d7223dd6ec9ff52183ab6","slug":"notebooks.autoencoder","location":"/notebooks/autoencoder.ipynb","dependencies":[],"frontmatter":{"title":"Using xbatcher to train an autoencoder","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"cookbook-dev","language":"python"},"authors":[{"nameParsed":{"literal":"Keenan Ganz, Nabin Kalauni, and The Project Pythia Community","given":"and The Project Pythia Community","family":"Keenan Ganz","suffix":"Nabin Kalauni"},"name":"Keenan Ganz, Nabin Kalauni, and The Project Pythia Community","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/xbatcher-deep-learning","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/xbatcher-deep-learning/blob/main/notebooks/autoencoder.ipynb","exports":[{"format":"ipynb","filename":"autoencoder.ipynb","url":"/xbatcher-deep-learning/build/autoencoder-a72d5ee971748a78c14de80e421cb4a4.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yEioyHaiBb"}],"key":"nKV0tHhj1g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gu2O3UZhTs"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"b7UgHO4hlG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In previous notebooks we have demonstrated how ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YNXw5KBkDl"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ByDm4wPlOw"},{"type":"text","value":" converts both toy ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I8mmyeUhsK"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ckVUYyg3Tl"},{"type":"text","value":" objects into tensors and back again. In this notebook we incorporate these functions in an end-to-end workflow training an autoencoder on an elevation dataset. Once trained, the model is used to reconstruct two datasets:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lOcgzm60bs"}],"key":"Zjx5xMztQm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The overall elevation tile","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O2LTpa5Kme"}],"key":"zP1wkUZEOM"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A data cube of the autoencoder’s latent dimension","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"A6ewI5jZel"}],"key":"AyJSuZZNls"}],"key":"ts16KzVvcc"},{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"C92ivCMCnX"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"RqPpEGn6pv"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This notebook assumes familiarity with ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZYyT5sykLE"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kbTIqAk5fD"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"no5jYHOoID"},{"type":"inlineCode","value":"xbatcher","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Wgl2PpD8bi"},{"type":"text","value":", and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vHc4lLXXXr"},{"type":"inlineCode","value":"torch","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MeKtZHtFp3"},{"type":"text","value":". You don’t have to know how autoencoders work - we explain that when necessary.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"akfYVpr62C"}],"key":"oJtp3W6nTp"},{"type":"table","position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FVwvdfqA2N"}],"key":"SZ3JxESn9P"},{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PCFMXKfjHu"}],"key":"NCmRnbNplt"},{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tBeEBlRg2c"}],"key":"M7WMhs6mCT"}],"key":"U0CXFkSaCk"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://tutorial.xarray.dev/overview/xarray-in-45-min.html","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Intro to Xarray","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"H5v9aLtiHP"}],"urlSource":"https://tutorial.xarray.dev/overview/xarray-in-45-min.html","key":"olmFvdK6Yl"}],"key":"DRlmbtyXbr"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"r6fFlEop8Z"}],"key":"e0uINByfmu"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Array indexing","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Sn0YiL77st"}],"key":"RPGhLH3G7d"}],"key":"N1xLbtYvBQ"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://projectpythia.org/xbatcher-deep-learning/notebooks/xbatcher-dataloading/","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Xbatcher fundamentals","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wRobDqzCFG"}],"urlSource":"https://projectpythia.org/xbatcher-deep-learning/notebooks/xbatcher-dataloading/","key":"ymGN2FB5xH"}],"key":"Vv7uiYvj54"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"EassENsRdo"}],"key":"YX2rNNu2m6"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Passing data to models","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LMbT2q4F8O"}],"key":"UOuC5WLGKK"}],"key":"QKHmwvx61Y"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"https://docs.pytorch.org/tutorials/beginner/basics/intro.html","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"PyTorch fundamentals","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"baVC2ALmjd"}],"urlSource":"https://docs.pytorch.org/tutorials/beginner/basics/intro.html","key":"OxuqmKWsYt"}],"key":"GoPkgjFpx0"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"XE8g3jU34O"}],"key":"f1tb2VazBo"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Model training loop","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"z8y5EqFhhx"}],"key":"RmHa64ma4u"}],"key":"J6oBVZAbum"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"https://lightning.ai/docs/pytorch/stable/notebooks/course_UvA-DL/08-deep-autoencoders.html","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Autoencoders","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yfSQmcgqsv"}],"urlSource":"https://lightning.ai/docs/pytorch/stable/notebooks/course_UvA-DL/08-deep-autoencoders.html","key":"BIOOSMH0SD"}],"key":"wJXfPdWgo5"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"eH1T7HNOaf"}],"key":"Zn4KtY94XX"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"More information on how autoencoders work.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"vQvoFJlsjR"}],"key":"VuZx2mWYFd"}],"key":"z7H4ckRjBX"}],"key":"VErl49ERKt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gYmQOiK6FD"}],"key":"KubnTQa7HQ"},{"type":"text","value":": 30 minutes.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"AiQGm8fEWq"}],"key":"m6vV10Oads"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"System requirements","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Z49GLsNByt"}],"key":"SkmptqSt4j"},{"type":"text","value":":","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"kVlR0EPpYA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Windows users may hit an import error on ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"eZZ0M6ECNP"},{"type":"inlineCode","value":"rioxarray","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"q8kooviQ1H"},{"type":"text","value":" (","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"y07B4OUkEp"},{"type":"link","url":"https://gis.stackexchange.com/questions/417733/unable-to-import-python-rasterio-package-even-though-it-is-installed","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"link","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"jHrAmdj8Ae"}],"urlSource":"https://gis.stackexchange.com/questions/417733/unable-to-import-python-rasterio-package-even-though-it-is-installed","key":"rWnF5JpHMJ"},{"type":"text","value":"). If that happens, add ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"rLWJmhrz3J"},{"type":"inlineCode","value":"import osgeo","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"K5iqSp0BiE"},{"type":"text","value":" above ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ncaRa6y3Ef"},{"type":"inlineCode","value":"import rioxarray","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"HJNLaNo1cU"},{"type":"text","value":" and that seems to fix the issue.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"JbeGnjiDwA"}],"key":"eNZ5LbUkH1"}],"key":"Sgb5WdwsAh"}],"key":"kWQiguDgFx"}],"key":"Ivt4H6cihM"}],"key":"gSPm2h4wiA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GzpUDnLcKu"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"IkvxoZYEo3"}],"key":"YknkTb2fMK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nif os.name == 'nt':\n    import osgeo\n\nfrom importlib import reload\n\n# DL stuff\nimport matplotlib.pyplot as plt\nimport torch\n\ntorch.set_default_dtype(torch.float64)\n\n# Geospatial stuff\nimport xarray as xr\nimport xbatcher\nimport rioxarray\nfrom xbatcher.loaders.torch import MapDataset\n\n# Etc\nimport numpy as np\nfrom numpy.linalg import norm\nfrom matplotlib import pyplot as plt\n\n# Locals\nimport functions\nimport autoencoder","key":"U4IrBWlG2K"},{"type":"output","id":"GZbODSMx7wCoJe9fzX4z5","data":[],"key":"QQyFpWD6r4"}],"key":"d8wIseBlbT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iLmECi6l7d"}],"identifier":"get-data","label":"Get data","html_id":"get-data","implicit":true,"key":"xop9al3GIV"}],"key":"LqnkMXxFKr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will start by pulling a segment of NASADEM for Washington’s Olympic peninsula. The entire DEM is also available on NASA Earthdata and Planetary Computer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eCJKpRFnXz"}],"key":"uSvW8IcJFb"}],"key":"MvTHQh5esa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Rasterio adds a blank edge. Trim these out.\ndem = rioxarray.open_rasterio(\"../ASTGTMV003_N47W124_dem.tif\")\ndem = dem.isel(y=slice(0, -1), x=slice(0, -1))\ndem = (dem - dem.min()) / (dem.max() - dem.min())\ndem","key":"xkARm9BCu1"},{"type":"output","id":"tp7RFxIIW8ELi6E_pYF_Q","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<xarray.DataArray (band: 1, y: 3600, x: 3600)> Size: 104MB\narray([[[0.23102867, 0.23608769, 0.23988196, ..., 0.10581788,\n         0.10961214, 0.11298482],\n        [0.23229342, 0.2386172 , 0.24283305, ..., 0.11045531,\n         0.11340641, 0.1163575 ],\n        [0.23102867, 0.23819562, 0.24325464, ..., 0.11467116,\n         0.1163575 , 0.11804384],\n        ...,\n        [0.00252951, 0.00252951, 0.00252951, ..., 0.03752108,\n         0.03625632, 0.03752108],\n        [0.00252951, 0.00252951, 0.00252951, ..., 0.03625632,\n         0.03499157, 0.03878583],\n        [0.0029511 , 0.0029511 , 0.0029511 , ..., 0.03667791,\n         0.03625632, 0.04005059]]], shape=(1, 3600, 3600))\nCoordinates:\n  * band         (band) int64 8B 1\n  * x            (x) float64 29kB -124.0 -124.0 -124.0 ... -123.0 -123.0 -123.0\n  * y            (y) float64 29kB 48.0 48.0 48.0 48.0 ... 47.0 47.0 47.0 47.0\n    spatial_ref  int64 8B 0","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (band: 1, y: 3600, x: 3600)&gt; Size: 104MB\narray([[[0.23102867, 0.23608769, 0.23988196, ..., 0.10581788,\n         0.10961214, 0.11298482],\n        [0.23229342, 0.2386172 , 0.24283305, ..., 0.11045531,\n         0.11340641, 0.1163575 ],\n        [0.23102867, 0.23819562, 0.24325464, ..., 0.11467116,\n         0.1163575 , 0.11804384],\n        ...,\n        [0.00252951, 0.00252951, 0.00252951, ..., 0.03752108,\n         0.03625632, 0.03752108],\n        [0.00252951, 0.00252951, 0.00252951, ..., 0.03625632,\n         0.03499157, 0.03878583],\n        [0.0029511 , 0.0029511 , 0.0029511 , ..., 0.03667791,\n         0.03625632, 0.04005059]]], shape=(1, 3600, 3600))\nCoordinates:\n  * band         (band) int64 8B 1\n  * x            (x) float64 29kB -124.0 -124.0 -124.0 ... -123.0 -123.0 -123.0\n  * y            (y) float64 29kB 48.0 48.0 48.0 48.0 ... 47.0 47.0 47.0 47.0\n    spatial_ref  int64 8B 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>band</span>: 1</li><li><span class='xr-has-index'>y</span>: 3600</li><li><span class='xr-has-index'>x</span>: 3600</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-cab86fb8-d049-4781-b15e-880c10c757a9' class='xr-array-in' type='checkbox' checked><label for='section-cab86fb8-d049-4781-b15e-880c10c757a9' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.231 0.2361 0.2399 0.2437 0.2462 ... 0.0371 0.03668 0.03626 0.04005</span></div><div class='xr-array-data'><pre>array([[[0.23102867, 0.23608769, 0.23988196, ..., 0.10581788,\n         0.10961214, 0.11298482],\n        [0.23229342, 0.2386172 , 0.24283305, ..., 0.11045531,\n         0.11340641, 0.1163575 ],\n        [0.23102867, 0.23819562, 0.24325464, ..., 0.11467116,\n         0.1163575 , 0.11804384],\n        ...,\n        [0.00252951, 0.00252951, 0.00252951, ..., 0.03752108,\n         0.03625632, 0.03752108],\n        [0.00252951, 0.00252951, 0.00252951, ..., 0.03625632,\n         0.03499157, 0.03878583],\n        [0.0029511 , 0.0029511 , 0.0029511 , ..., 0.03667791,\n         0.03625632, 0.04005059]]], shape=(1, 3600, 3600))</pre></div></div></li><li class='xr-section-item'><input id='section-ffd21aca-efce-4ceb-8849-974349fd2ff5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ffd21aca-efce-4ceb-8849-974349fd2ff5' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-664ef4c7-bc45-4ea4-bcb7-9320836a21b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-664ef4c7-bc45-4ea4-bcb7-9320836a21b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18facee9-1527-49ac-85bb-f4f6ac42c5a6' class='xr-var-data-in' type='checkbox'><label for='data-18facee9-1527-49ac-85bb-f4f6ac42c5a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-124.0 -124.0 ... -123.0 -123.0</div><input id='attrs-3222656d-7cf4-4887-8798-aa8b5662545f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3222656d-7cf4-4887-8798-aa8b5662545f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf17e0f0-d929-43db-a247-f376d9e9d6aa' class='xr-var-data-in' type='checkbox'><label for='data-bf17e0f0-d929-43db-a247-f376d9e9d6aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-124.      , -123.999722, -123.999444, ..., -123.000833, -123.000556,\n       -123.000278], shape=(3600,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>48.0 48.0 48.0 ... 47.0 47.0 47.0</div><input id='attrs-e58a5852-6f9d-4473-b555-900bdba3e63f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e58a5852-6f9d-4473-b555-900bdba3e63f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17a68a8e-11b6-4b87-98c1-a3014cb12e1f' class='xr-var-data-in' type='checkbox'><label for='data-17a68a8e-11b6-4b87-98c1-a3014cb12e1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([48.      , 47.999722, 47.999444, ..., 47.000833, 47.000556, 47.000278],\n      shape=(3600,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-d4d2880b-1563-4070-8e43-3eb71a355789' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d4d2880b-1563-4070-8e43-3eb71a355789' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a99e29d3-8bb9-4125-95c5-0eae4be2d9b7' class='xr-var-data-in' type='checkbox'><label for='data-a99e29d3-8bb9-4125-95c5-0eae4be2d9b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>-124.000138888889 0.000277777777777778 0.0 48.0001388888889 0.0 -0.000277777777777778</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7707fa71-09a8-483f-ae72-c564efa4fc19' class='xr-section-summary-in' type='checkbox'  ><label for='section-7707fa71-09a8-483f-ae72-c564efa4fc19' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>band</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-abf3053f-97ea-4710-92fb-97c8c05486e6' class='xr-index-data-in' type='checkbox'/><label for='index-abf3053f-97ea-4710-92fb-97c8c05486e6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1], dtype=&#x27;int64&#x27;, name=&#x27;band&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-aa331d82-c09b-4f78-90dd-9f20f5af6afe' class='xr-index-data-in' type='checkbox'/><label for='index-aa331d82-c09b-4f78-90dd-9f20f5af6afe' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-124.00000000000011, -123.99972222222233, -123.99944444444456,\n       -123.99916666666678,   -123.998888888889, -123.99861111111123,\n       -123.99833333333345, -123.99805555555567,  -123.9977777777779,\n       -123.99750000000012,\n       ...\n        -123.0027777777779, -123.00250000000011, -123.00222222222233,\n       -123.00194444444456, -123.00166666666678,   -123.001388888889,\n       -123.00111111111123, -123.00083333333345, -123.00055555555566,\n        -123.0002777777779],\n      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=3600))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-911cc5c4-df3a-4995-8962-ab7a492cea58' class='xr-index-data-in' type='checkbox'/><label for='index-911cc5c4-df3a-4995-8962-ab7a492cea58' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 48.00000000000001,  47.99972222222223,  47.99944444444445,\n       47.999166666666675,   47.9988888888889,  47.99861111111112,\n        47.99833333333334,  47.99805555555556, 47.997777777777785,\n        47.99750000000001,\n       ...\n        47.00277777777779, 47.002500000000005,  47.00222222222223,\n        47.00194444444445,  47.00166666666667,   47.0013888888889,\n       47.001111111111115,  47.00083333333334, 47.000555555555565,\n        47.00027777777778],\n      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=3600))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-01491e61-c40d-4970-b6aa-21a9182448ac' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-01491e61-c40d-4970-b6aa-21a9182448ac' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"rbSnUHvC70"}],"key":"VHL3UrDywP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we rescaled the DEM to be in the range [0, 1]. This modification makes it easier for the autoencoder to train.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NJ75uAlmhE"}],"key":"bLI0lNCrol"}],"key":"wvye0PnSjh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dem.isel(band=0).plot.imshow(cmap=\"terrain\")","key":"znVgn6ioEM"},{"type":"output","id":"qJf56CHNZK2-HfqA5M_U-","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1cb8ea788a60bb17e4ad00f08f6dc7d2","path":"/xbatcher-deep-learning/build/1cb8ea788a60bb17e4ad00f08f6dc7d2.png"}}}],"key":"RHW2h17GMA"}],"key":"eliu6PIlxP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate training examples","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xgbU2wnOFO"}],"identifier":"generate-training-examples","label":"Generate training examples","html_id":"generate-training-examples","implicit":true,"key":"Ds2I5G6n2I"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here, we use xbatcher to generate patches of terrain. Even though we did not specify the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"odoJ99A0bL"},{"type":"inlineCode","value":"band","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ii0ENL2349"},{"type":"text","value":" axis in the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z5Sn2ey6oC"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Jbjp6HVSsK"},{"type":"text","value":", this axis still propagates to the output tensor’s second axis. Remember that torch data loaders add a batch dimension, so the tensor’s first axis is not relevant to the original xarray object.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KnQK2KOHeV"}],"key":"vISbyXwM8g"}],"key":"l9WfG0zFx0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bgen_x = xbatcher.BatchGenerator(\n    dem,\n    input_dims=dict(x=32, y=32),\n    input_overlap=dict(x=16, y=16)\n)\n\nds = MapDataset(\n    X_generator=bgen_x\n)\n\nloader = torch.utils.data.DataLoader(ds, batch_size=16, shuffle=True)","key":"MBdftfuR73"},{"type":"output","id":"Xaeg6y9pn-yYjZR1l3laQ","data":[],"key":"QaJTpCas5M"}],"key":"eRdfa2T03n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"X = next(iter(loader))\n\nprint(\"Input tensor shape:\", X.shape)","key":"gGrRZddiNh"},{"type":"output","id":"VzGbm39t_IBVjsZ4iy08u","data":[{"output_type":"stream","name":"stdout","text":"Input tensor shape: torch.Size([16, 1, 32, 32])\n"}],"key":"efUafPitPN"}],"key":"cD9wQe53yA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bXbIu3XgNp"}],"identifier":"model-setup","label":"Model setup","html_id":"model-setup","implicit":true,"key":"H4fuUAQBKU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we instantiate the autoencoder class and verify that the output shape is what we expect. Autoencoders compress input data to a latent space and then reconstruct the input from the compressed representation. Usually, we are interested in the compressed result, but during training we are trying to recreate the input exactly. Therefore, the output tensor should match the shape of the input tensor.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KBl7TjO8JI"}],"key":"OLuzSp88Wt"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Input tensor:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oWKqxks6lE"}],"key":"CWOH43qXC0"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"comment","value":" Horizontal lines ","key":"lQ6wAe3mUJ"},{"type":"comment","value":" Vertical lines ","key":"ksVRVuMOUK"},{"type":"comment","value":" Colored Rectangle ","key":"zAXUTPFa58"},{"type":"comment","value":" Horizontal lines ","key":"eZEFB1LwhI"},{"type":"comment","value":" Vertical lines ","key":"rafqfaB7x2"},{"type":"comment","value":" Colored Rectangle ","key":"r1VhYU0g9K"},{"type":"comment","value":" Horizontal lines ","key":"e0MOipNTay"},{"type":"comment","value":" Vertical lines ","key":"swW9bSHry0"},{"type":"comment","value":" Colored Rectangle ","key":"lJEUOKNqHm"},{"type":"comment","value":" Text ","key":"meZHo91pXU"}],"key":"qmqsTfGTiP"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Output tensor:","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"SpnsTJXNMC"}],"key":"FIuSqS0G0H"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"comment","value":" Horizontal lines ","key":"r9RsTTUT4S"},{"type":"comment","value":" Vertical lines ","key":"otfTNowpmj"},{"type":"comment","value":" Colored Rectangle ","key":"eZGGPismIN"},{"type":"comment","value":" Horizontal lines ","key":"GaeQsuqMY7"},{"type":"comment","value":" Vertical lines ","key":"Z064DhgFEN"},{"type":"comment","value":" Colored Rectangle ","key":"Sg599lpKB1"},{"type":"comment","value":" Horizontal lines ","key":"JcNEctnNi7"},{"type":"comment","value":" Vertical lines ","key":"hbGHTQvovz"},{"type":"comment","value":" Colored Rectangle ","key":"M1eC3bWWIw"},{"type":"comment","value":" Text ","key":"L3YYIw9IUB"}],"key":"U4LYZjAkuv"}],"key":"TTTdQdLVyM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import dask.array.svg as svg\nfrom IPython.display import HTML \n\nsvg.svg(((50,), (10,), (10,)), size=100).replace(\"\\n\", \"\")","key":"dV09BCRWkh"},{"type":"output","id":"shwDliN7Bqk55P-Eyaud0","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"'<svg width=\"153\" height=\"143\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >  <!-- Horizontal lines -->  <line x1=\"10\" y1=\"0\" x2=\"68\" y2=\"58\" style=\"stroke-width:2\" />  <line x1=\"10\" y1=\"35\" x2=\"68\" y2=\"93\" style=\"stroke-width:2\" />  <!-- Vertical lines -->  <line x1=\"10\" y1=\"0\" x2=\"10\" y2=\"35\" style=\"stroke-width:2\" />  <line x1=\"68\" y1=\"58\" x2=\"68\" y2=\"93\" style=\"stroke-width:2\" />  <!-- Colored Rectangle -->  <polygon points=\"10.0,0.0 68.82352941176471,58.82352941176471 68.82352941176471,93.8317713259397 10.0,35.00824191417499\" style=\"fill:#ECB172A0;stroke-width:0\"/>  <!-- Horizontal lines -->  <line x1=\"10\" y1=\"0\" x2=\"45\" y2=\"0\" style=\"stroke-width:2\" />  <line x1=\"68\" y1=\"58\" x2=\"103\" y2=\"58\" style=\"stroke-width:2\" />  <!-- Vertical lines -->  <line x1=\"10\" y1=\"0\" x2=\"68\" y2=\"58\" style=\"stroke-width:2\" />  <line x1=\"45\" y1=\"0\" x2=\"103\" y2=\"58\" style=\"stroke-width:2\" />  <!-- Colored Rectangle -->  <polygon points=\"10.0,0.0 45.00824191417499,0.0 103.8317713259397,58.82352941176471 68.82352941176471,58.82352941176471\" style=\"fill:#ECB172A0;stroke-width:0\"/>  <!-- Horizontal lines -->  <line x1=\"68\" y1=\"58\" x2=\"103\" y2=\"58\" style=\"stroke-width:2\" />  <line x1=\"68\" y1=\"93\" x2=\"103\" y2=\"93\" style=\"stroke-width:2\" />  <!-- Vertical lines -->  <line x1=\"68\" y1=\"58\" x2=\"68\" y2=\"93\" style=\"stroke-width:2\" />  <line x1=\"103\" y1=\"58\" x2=\"103\" y2=\"93\" style=\"stroke-width:2\" />  <!-- Colored Rectangle -->  <polygon points=\"68.82352941176471,58.82352941176471 103.8317713259397,58.82352941176471 103.8317713259397,93.8317713259397 68.82352941176471,93.8317713259397\" style=\"fill:#ECB172A0;stroke-width:0\"/>  <!-- Text -->  <text x=\"86.327650\" y=\"113.831771\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >10</text>  <text x=\"123.831771\" y=\"76.327650\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,123.831771,76.327650)\">10</text>  <text x=\"29.411765\" y=\"84.420007\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,29.411765,84.420007)\">50</text></svg>'","content_type":"text/plain"}}}],"key":"xg4Y92LVNi"}],"key":"SilH12HXo1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = autoencoder.Autoencoder(base_channel_size=32, latent_dim=64, num_input_channels=1, width=32, height=32)\nopt = m._configure_optimizers()","key":"zhuDtg58ca"},{"type":"output","id":"orWD4TIbY5QF9TBmK7xMY","data":[],"key":"ZMbjYAJH3w"}],"key":"YGN1JZ4s99"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"out = m(X)\nprint(out.shape)\nassert(out.shape == X.shape)","key":"bMl8OWY4OM"},{"type":"output","id":"c7gevNxFSfhMTAeDsjQue","data":[{"output_type":"stream","name":"stdout","text":"torch.Size([16, 1, 32, 32])\n"}],"key":"GYqcPQlAwD"}],"key":"sKRg5vWpfj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model training","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I1y7VJJOFM"}],"identifier":"model-training","label":"Model training","html_id":"model-training","implicit":true,"key":"rwXCJwMNS0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We aren’t using pytorch-lightning and load a pre-trained model here to keep the notebook environment lean. For your project, we highly recommend using a framework to abstract away much of the boilerplate code below.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LM8kbJFEbe"}],"key":"ZFWX3BYKNW"}],"key":"dwQuUEBWxj"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"def train_one_epoch(epoch_index):\n    last_loss = 0.\n    running_loss = 0.\n    \n    for i, batch in enumerate(tqdm(loader)):\n        # Zero your gradients for every batch!\n        opt.zero_grad()\n\n        # Make predictions for this batch\n        outputs = m(batch)\n\n        # Compute the loss and its gradients\n        loss = m._get_reconstruction_loss(batch, outputs)\n        loss.backward()\n        running_loss += loss.item()\n\n        # Adjust learning weights\n        opt.step()\n\n    return running_loss / len(loader)","key":"tXEsba6VtF"}],"key":"EUR5RztqNg"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"n_epochs = 5\nfor i_epoch in range(n_epochs):\n    loss = train_one_epoch(i_epoch)\n    print(f\"Epoch {i_epoch+1:>3}: {loss:.3e}\")","key":"DMziJm13p2"}],"key":"bRsIdSaeas"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"torch.save(m.state_dict(), \"../autoencoder.torch\")","key":"u1F9YE79RS"}],"key":"Yb1T3tnMG3"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"danger","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Danger","key":"EQS7U6GXil"}],"key":"eVLedQjpb9"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This model is certainly overfitted. For brevity we have omitted a validation dataset, which is essential for building models that generalize well on unseen data.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uYLTvELljw"}],"key":"dOS0rvOM3R"}],"key":"iJeX8Yxx5C"}],"key":"ugpCPc70u5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m.load_state_dict(torch.load(\"../autoencoder.torch\", weights_only=True))","key":"ENSiEAd37f"},{"type":"output","id":"HIWYVJ6ekhg0nLVm9GdZr","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"<All keys matched successfully>","content_type":"text/plain"}}}],"key":"nD7LHIGhYU"}],"key":"DX9P3StHVS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m.eval()\nn_examples = 4\ninputs = next(iter(loader))\noutputs = m(inputs)\n\ninputs = inputs.detach().cpu().numpy()\noutputs = outputs.detach().cpu().numpy()","key":"Q1xv5GW4l4"},{"type":"output","id":"jndajPo4kWgZr1I5WqyUV","data":[],"key":"XTExBZ6tsC"}],"key":"BVGJHlbtof"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(2, n_examples)\n\nfor i_col in range(n_examples):\n    axes[0, i_col].imshow(inputs[i_col, 0, ...])\n    axes[1, i_col].imshow(outputs[i_col, 0, ...])\n\nfor a in axes.flat:\n    a.set_xticks([])\n    a.set_yticks([])\n\naxes[0, 0].set_ylabel(\"Original patch\")\naxes[1, 0].set_ylabel(\"Reconstruction\")\n\nfig.tight_layout()\nplt.show()","key":"TtqpSnWWZi"},{"type":"output","id":"-DE9rWCMwUmhVx9r_2TTi","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 8 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"28ed50804d129f300709fdc0ded7c5a8","path":"/xbatcher-deep-learning/build/28ed50804d129f300709fdc0ded7c5a8.png"}}}],"key":"TGJMcOEttV"}],"key":"WcNbKljtqZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reconstruction 1: Getting the full array back","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j5WcjLCcpo"}],"identifier":"reconstruction-1-getting-the-full-array-back","label":"Reconstruction 1: Getting the full array back","html_id":"reconstruction-1-getting-the-full-array-back","implicit":true,"key":"sjwU4HDpzW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Suppose we would like to evaluate how the autoencoder does on reconstructing the entire terrain patch by combining outputs across all input patches. To do so we can use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q8UV61mnCV"},{"type":"inlineCode","value":"predict_on_array","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mkPTZir3KE"},{"type":"text","value":" function described in the previous notebook. Our model outputs tensors with shape ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yQ7KCqWgs8"},{"type":"inlineCode","value":"(band=1, x=32, y=32)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"adMDmaW567"},{"type":"text","value":". We need to specify each of these axes in the call to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bKH01FhMzz"},{"type":"inlineCode","value":"predict_on_array","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y80hfRamP9"},{"type":"text","value":". ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AsZrcNqmAe"},{"type":"inlineCode","value":"band","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xOSn6LI9qk"},{"type":"text","value":" does not change size and is not used by the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KJZlfWN8b1"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vYWE5vqtQ0"},{"type":"text","value":", so it goes in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QcxqpPeT0x"},{"type":"inlineCode","value":"core_dim","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zy8HIGhLnf"},{"type":"text","value":". Both ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m5JYOvmaD2"},{"type":"inlineCode","value":"x","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k3htgm0IA9"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i51Fz1IqqZ"},{"type":"inlineCode","value":"y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BqFdL6BHuA"},{"type":"text","value":" are used by the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jS5xde3Nk0"},{"type":"inlineCode","value":"BatchGenerator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ng4Fz0wLxd"},{"type":"text","value":", so although they do not change size they still go in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ktCuos3hUO"},{"type":"inlineCode","value":"resample_dim","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pj58nDfPKO"},{"type":"text","value":". That accounts for all tensor axes, so we can leave the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Olm9d4bqM2"},{"type":"inlineCode","value":"new_dim","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cZDlBwpoRs"},{"type":"text","value":" argument as an empty list.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qaqVQlvtzj"}],"key":"wR5pfSaWjP"}],"key":"cRe40I7tjf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dem_reconst = functions.predict_on_array(\n    dataset=ds,\n    model=m,\n    output_tensor_dim=dict(band=1, y=32, x=32),\n    new_dim=[],\n    core_dim=[\"band\"],\n    resample_dim=[\"x\", \"y\"]\n)","key":"KaXEeTlbzp"},{"type":"output","id":"Nie6anEIwYG-XfdJrVvxo","data":[{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/3136 [00:00<?, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\r  0%|          | 3/3136 [00:00<01:51, 28.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r  0%|          | 6/3136 [00:00<01:53, 27.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r  0%|          | 9/3136 [00:00<01:53, 27.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r  0%|          | 12/3136 [00:00<01:53, 27.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r  0%|          | 15/3136 [00:00<01:51, 27.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 18/3136 [00:00<01:49, 28.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 21/3136 [00:00<01:48, 28.67it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 24/3136 [00:00<01:49, 28.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 27/3136 [00:01<02:08, 24.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 30/3136 [00:01<02:03, 25.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 33/3136 [00:01<01:59, 25.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 36/3136 [00:01<01:56, 26.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 39/3136 [00:01<01:53, 27.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|▏         | 43/3136 [00:01<01:49, 28.17it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|▏         | 46/3136 [00:01<01:49, 28.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 49/3136 [00:01<01:49, 28.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 52/3136 [00:01<01:50, 27.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 55/3136 [00:02<01:50, 27.90it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 58/3136 [00:02<01:50, 27.85it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 61/3136 [00:02<01:50, 27.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 64/3136 [00:02<01:48, 28.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 68/3136 [00:02<01:41, 30.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 72/3136 [00:02<01:37, 31.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 76/3136 [00:02<01:33, 32.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 80/3136 [00:02<01:31, 33.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 84/3136 [00:02<01:29, 34.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 88/3136 [00:03<01:28, 34.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 92/3136 [00:03<01:29, 33.96it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 96/3136 [00:03<01:31, 33.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 100/3136 [00:03<01:31, 33.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 104/3136 [00:03<01:31, 33.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 108/3136 [00:03<01:27, 34.53it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▎         | 112/3136 [00:03<01:34, 32.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▎         | 116/3136 [00:03<01:31, 32.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 120/3136 [00:03<01:29, 33.53it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 124/3136 [00:04<01:28, 33.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 128/3136 [00:04<01:28, 34.13it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 132/3136 [00:04<01:27, 34.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 136/3136 [00:04<01:26, 34.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 140/3136 [00:04<01:25, 35.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▍         | 145/3136 [00:04<01:20, 37.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▍         | 150/3136 [00:04<01:17, 38.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▍         | 155/3136 [00:04<01:15, 39.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▌         | 160/3136 [00:05<01:14, 39.96it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▌         | 165/3136 [00:05<01:13, 40.48it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▌         | 170/3136 [00:05<01:12, 41.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▌         | 175/3136 [00:05<01:11, 41.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▌         | 180/3136 [00:05<01:11, 41.27it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▌         | 185/3136 [00:05<01:11, 41.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▌         | 190/3136 [00:05<01:11, 41.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▌         | 195/3136 [00:05<01:11, 41.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▋         | 200/3136 [00:06<01:14, 39.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 204/3136 [00:06<01:14, 39.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 208/3136 [00:06<01:14, 39.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 213/3136 [00:06<01:13, 40.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 218/3136 [00:06<01:12, 40.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 223/3136 [00:06<01:11, 40.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 228/3136 [00:06<01:10, 41.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 233/3136 [00:06<01:10, 41.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 238/3136 [00:06<01:10, 41.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 243/3136 [00:07<01:09, 41.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 248/3136 [00:07<01:09, 41.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 253/3136 [00:07<01:09, 41.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 258/3136 [00:07<01:09, 41.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 263/3136 [00:07<01:08, 41.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▊         | 268/3136 [00:07<01:09, 41.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▊         | 273/3136 [00:07<01:08, 41.61it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▉         | 278/3136 [00:07<01:08, 41.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▉         | 283/3136 [00:08<01:08, 41.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▉         | 288/3136 [00:08<01:08, 41.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▉         | 293/3136 [00:08<01:08, 41.59it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|▉         | 298/3136 [00:08<01:08, 41.66it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|▉         | 303/3136 [00:08<01:08, 41.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|▉         | 308/3136 [00:08<01:07, 41.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|▉         | 313/3136 [00:08<01:08, 41.39it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|█         | 318/3136 [00:08<01:07, 41.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|█         | 323/3136 [00:08<01:07, 41.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|█         | 328/3136 [00:09<01:07, 41.59it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█         | 333/3136 [00:09<01:07, 41.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█         | 338/3136 [00:09<01:06, 41.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█         | 343/3136 [00:09<01:06, 41.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█         | 348/3136 [00:09<01:07, 41.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█▏        | 353/3136 [00:09<01:08, 40.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█▏        | 358/3136 [00:09<01:11, 38.99it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 363/3136 [00:09<01:10, 39.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 368/3136 [00:10<01:09, 39.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 373/3136 [00:10<01:08, 40.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 378/3136 [00:10<01:07, 40.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 383/3136 [00:10<01:07, 40.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 388/3136 [00:10<01:06, 41.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 393/3136 [00:10<01:07, 40.87it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 398/3136 [00:10<01:06, 40.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 403/3136 [00:10<01:06, 40.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 408/3136 [00:11<01:06, 40.85it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 413/3136 [00:11<01:06, 40.88it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 418/3136 [00:11<01:06, 40.87it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 423/3136 [00:11<01:06, 40.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▎        | 428/3136 [00:11<01:07, 39.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▍        | 432/3136 [00:11<01:11, 37.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▍        | 436/3136 [00:11<01:10, 38.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▍        | 441/3136 [00:11<01:09, 38.93it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▍        | 446/3136 [00:12<01:08, 39.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▍        | 450/3136 [00:12<01:07, 39.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▍        | 455/3136 [00:12<01:07, 39.91it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▍        | 460/3136 [00:12<01:06, 40.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▍        | 465/3136 [00:12<01:06, 40.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▍        | 470/3136 [00:12<01:06, 40.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▌        | 475/3136 [00:12<01:05, 40.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▌        | 480/3136 [00:12<01:05, 40.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▌        | 485/3136 [00:13<01:05, 40.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▌        | 490/3136 [00:13<01:05, 40.65it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▌        | 495/3136 [00:13<01:04, 40.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▌        | 500/3136 [00:13<01:04, 40.57it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▌        | 505/3136 [00:13<01:04, 40.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▋        | 510/3136 [00:13<01:04, 40.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▋        | 515/3136 [00:13<01:04, 40.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 520/3136 [00:13<01:04, 40.56it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 525/3136 [00:13<01:04, 40.67it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 530/3136 [00:14<01:04, 40.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 535/3136 [00:14<01:04, 40.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 540/3136 [00:14<01:04, 40.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 545/3136 [00:14<01:03, 40.53it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 550/3136 [00:14<01:05, 39.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 554/3136 [00:14<01:05, 39.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 558/3136 [00:14<01:05, 39.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 563/3136 [00:14<01:04, 39.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 568/3136 [00:15<01:04, 40.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 573/3136 [00:15<01:03, 40.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 578/3136 [00:15<01:03, 40.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▊        | 583/3136 [00:15<01:02, 40.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▉        | 588/3136 [00:15<01:02, 40.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▉        | 593/3136 [00:15<01:02, 40.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▉        | 598/3136 [00:15<01:02, 40.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▉        | 603/3136 [00:15<01:02, 40.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▉        | 608/3136 [00:16<01:02, 40.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|█▉        | 613/3136 [00:16<01:02, 40.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|█▉        | 618/3136 [00:16<01:02, 40.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|█▉        | 623/3136 [00:16<01:02, 40.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|██        | 628/3136 [00:16<01:01, 40.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|██        | 633/3136 [00:16<01:02, 40.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|██        | 638/3136 [00:16<01:01, 40.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██        | 643/3136 [00:16<01:01, 40.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██        | 648/3136 [00:17<01:01, 40.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██        | 653/3136 [00:17<01:01, 40.17it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██        | 658/3136 [00:17<01:03, 38.84it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██        | 663/3136 [00:17<01:02, 39.31it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██▏       | 668/3136 [00:17<01:02, 39.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██▏       | 672/3136 [00:17<01:02, 39.67it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 677/3136 [00:17<01:01, 39.93it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 682/3136 [00:17<01:01, 40.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 687/3136 [00:18<01:01, 39.73it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 692/3136 [00:18<01:01, 39.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 697/3136 [00:18<01:01, 39.90it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 701/3136 [00:18<01:01, 39.86it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 706/3136 [00:18<01:00, 40.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 710/3136 [00:18<01:00, 39.99it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 714/3136 [00:18<01:00, 39.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 719/3136 [00:18<01:00, 40.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 724/3136 [00:18<01:00, 40.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 729/3136 [00:19<01:00, 40.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 734/3136 [00:19<01:00, 40.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▎       | 739/3136 [00:19<01:00, 39.93it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▎       | 743/3136 [00:19<01:00, 39.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 747/3136 [00:19<00:59, 39.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 751/3136 [00:19<00:59, 39.86it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 755/3136 [00:19<00:59, 39.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 759/3136 [00:19<00:59, 39.75it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 763/3136 [00:19<00:59, 39.72it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 767/3136 [00:20<01:03, 37.57it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▍       | 771/3136 [00:20<01:01, 38.17it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▍       | 776/3136 [00:20<01:00, 38.87it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▍       | 780/3136 [00:20<01:00, 38.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▌       | 784/3136 [00:20<01:00, 38.56it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▌       | 789/3136 [00:20<00:59, 39.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▌       | 793/3136 [00:20<00:59, 39.36it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▌       | 797/3136 [00:20<00:59, 39.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▌       | 801/3136 [00:20<00:59, 39.53it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▌       | 805/3136 [00:21<00:58, 39.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▌       | 810/3136 [00:21<00:58, 39.75it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▌       | 815/3136 [00:21<00:58, 39.91it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▌       | 820/3136 [00:21<00:57, 40.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▋       | 825/3136 [00:21<00:57, 39.97it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▋       | 829/3136 [00:21<00:58, 39.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 834/3136 [00:21<00:57, 39.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 839/3136 [00:21<00:57, 40.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 844/3136 [00:21<00:56, 40.56it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 849/3136 [00:22<00:57, 39.93it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 854/3136 [00:22<00:56, 40.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 859/3136 [00:22<00:58, 39.03it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 863/3136 [00:22<00:58, 38.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 867/3136 [00:22<00:59, 38.31it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 871/3136 [00:22<00:58, 38.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 876/3136 [00:22<00:57, 39.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 881/3136 [00:22<00:57, 39.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 885/3136 [00:23<00:56, 39.59it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 889/3136 [00:23<00:56, 39.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 893/3136 [00:23<00:56, 39.72it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▊       | 898/3136 [00:23<00:55, 39.99it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▉       | 903/3136 [00:23<00:55, 40.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▉       | 908/3136 [00:23<00:55, 40.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▉       | 913/3136 [00:23<00:55, 40.06it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▉       | 918/3136 [00:23<00:55, 40.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▉       | 923/3136 [00:23<00:55, 40.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|██▉       | 928/3136 [00:24<00:54, 40.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|██▉       | 933/3136 [00:24<00:54, 40.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|██▉       | 938/3136 [00:24<00:54, 40.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|███       | 943/3136 [00:24<00:54, 39.90it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|███       | 947/3136 [00:24<00:55, 39.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|███       | 951/3136 [00:24<00:54, 39.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|███       | 956/3136 [00:24<00:54, 40.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███       | 961/3136 [00:24<00:54, 40.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███       | 966/3136 [00:25<00:53, 40.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███       | 971/3136 [00:25<00:53, 40.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███       | 976/3136 [00:25<00:53, 40.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███▏      | 981/3136 [00:25<00:53, 40.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███▏      | 986/3136 [00:25<00:52, 40.64it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 991/3136 [00:25<00:52, 40.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 996/3136 [00:25<00:52, 41.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 1001/3136 [00:25<00:51, 41.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 1006/3136 [00:26<00:51, 41.40it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 1011/3136 [00:26<00:51, 41.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 1016/3136 [00:26<00:50, 41.88it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 1021/3136 [00:26<00:50, 42.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 1026/3136 [00:26<00:49, 42.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 1031/3136 [00:26<00:49, 42.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 1036/3136 [00:26<00:49, 42.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 1041/3136 [00:26<00:49, 42.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 1046/3136 [00:26<00:49, 42.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▎      | 1051/3136 [00:27<00:49, 42.40it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▎      | 1056/3136 [00:27<00:48, 42.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▍      | 1061/3136 [00:27<00:48, 42.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▍      | 1066/3136 [00:27<00:48, 42.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▍      | 1071/3136 [00:27<00:49, 42.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▍      | 1076/3136 [00:27<00:48, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▍      | 1081/3136 [00:27<00:48, 42.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▍      | 1086/3136 [00:27<00:48, 42.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▍      | 1091/3136 [00:28<00:48, 42.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▍      | 1096/3136 [00:28<00:48, 42.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▌      | 1101/3136 [00:28<00:48, 42.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▌      | 1106/3136 [00:28<00:48, 42.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▌      | 1111/3136 [00:28<00:47, 42.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▌      | 1116/3136 [00:28<00:47, 42.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▌      | 1121/3136 [00:28<00:47, 42.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▌      | 1126/3136 [00:28<00:47, 42.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▌      | 1131/3136 [00:28<00:47, 42.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▌      | 1136/3136 [00:29<00:47, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▋      | 1141/3136 [00:29<00:47, 42.27it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 1146/3136 [00:29<00:46, 42.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 1151/3136 [00:29<00:46, 42.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 1156/3136 [00:29<00:46, 42.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 1161/3136 [00:29<00:46, 42.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 1166/3136 [00:29<00:46, 42.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 1171/3136 [00:29<00:46, 42.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1176/3136 [00:30<00:46, 42.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1181/3136 [00:30<00:46, 41.99it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1186/3136 [00:30<00:46, 41.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1191/3136 [00:30<00:46, 42.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1196/3136 [00:30<00:45, 42.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1201/3136 [00:30<00:45, 42.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 1206/3136 [00:30<00:45, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▊      | 1211/3136 [00:30<00:45, 42.33it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▉      | 1216/3136 [00:30<00:45, 42.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▉      | 1221/3136 [00:31<00:45, 42.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▉      | 1226/3136 [00:31<00:45, 42.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▉      | 1231/3136 [00:31<00:45, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▉      | 1236/3136 [00:31<00:44, 42.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|███▉      | 1241/3136 [00:31<00:45, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|███▉      | 1246/3136 [00:31<00:44, 42.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|███▉      | 1251/3136 [00:31<00:44, 42.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|████      | 1256/3136 [00:31<00:44, 42.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|████      | 1261/3136 [00:32<00:44, 42.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|████      | 1266/3136 [00:32<00:44, 42.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████      | 1271/3136 [00:32<00:44, 41.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████      | 1276/3136 [00:32<00:44, 41.85it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████      | 1281/3136 [00:32<00:44, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████      | 1286/3136 [00:32<00:44, 42.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████      | 1291/3136 [00:32<00:43, 42.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████▏     | 1296/3136 [00:32<00:43, 42.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████▏     | 1301/3136 [00:32<00:43, 42.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 1306/3136 [00:33<00:43, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 1311/3136 [00:33<00:43, 42.36it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 1316/3136 [00:33<00:43, 42.31it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 1321/3136 [00:33<00:42, 42.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 1326/3136 [00:33<00:42, 42.59it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 1331/3136 [00:33<00:42, 42.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 1336/3136 [00:33<00:42, 42.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 1341/3136 [00:33<00:42, 42.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 1346/3136 [00:34<00:42, 42.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 1351/3136 [00:34<00:42, 42.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 1356/3136 [00:34<00:42, 42.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 1361/3136 [00:34<00:42, 41.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▎     | 1366/3136 [00:34<00:42, 41.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▎     | 1371/3136 [00:34<00:42, 41.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▍     | 1376/3136 [00:34<00:42, 41.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▍     | 1381/3136 [00:34<00:42, 41.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▍     | 1386/3136 [00:35<00:43, 40.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▍     | 1391/3136 [00:35<00:43, 40.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▍     | 1396/3136 [00:35<00:42, 41.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▍     | 1401/3136 [00:35<00:41, 41.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▍     | 1406/3136 [00:35<00:41, 41.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▍     | 1411/3136 [00:35<00:41, 41.73it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▌     | 1416/3136 [00:35<00:41, 41.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▌     | 1421/3136 [00:35<00:40, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▌     | 1426/3136 [00:35<00:40, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▌     | 1431/3136 [00:36<00:40, 42.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▌     | 1436/3136 [00:36<00:40, 42.10it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▌     | 1441/3136 [00:36<00:40, 41.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▌     | 1446/3136 [00:36<00:40, 41.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▋     | 1451/3136 [00:36<00:40, 41.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▋     | 1456/3136 [00:36<00:39, 42.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 1461/3136 [00:36<00:39, 42.17it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 1466/3136 [00:36<00:39, 42.36it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 1471/3136 [00:37<00:39, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 1476/3136 [00:37<00:39, 42.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 1481/3136 [00:37<00:39, 42.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 1486/3136 [00:37<00:39, 41.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 1491/3136 [00:37<00:39, 41.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 1496/3136 [00:37<00:39, 41.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 1501/3136 [00:37<00:39, 41.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 1506/3136 [00:37<00:38, 41.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 1511/3136 [00:38<00:38, 41.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 1516/3136 [00:38<00:39, 41.53it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▊     | 1521/3136 [00:38<00:39, 41.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▊     | 1526/3136 [00:38<00:39, 40.73it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▉     | 1531/3136 [00:38<00:39, 40.57it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▉     | 1536/3136 [00:38<00:39, 40.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▉     | 1541/3136 [00:38<00:39, 40.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▉     | 1546/3136 [00:38<00:38, 40.97it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▉     | 1551/3136 [00:38<00:38, 41.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|████▉     | 1556/3136 [00:39<00:38, 41.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|████▉     | 1561/3136 [00:39<00:38, 41.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|████▉     | 1566/3136 [00:39<00:37, 41.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|█████     | 1571/3136 [00:39<00:37, 41.72it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|█████     | 1576/3136 [00:39<00:37, 41.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|█████     | 1581/3136 [00:39<00:37, 41.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████     | 1586/3136 [00:39<00:38, 40.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████     | 1591/3136 [00:39<00:38, 40.31it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████     | 1596/3136 [00:40<00:38, 40.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████     | 1601/3136 [00:40<00:38, 40.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████     | 1606/3136 [00:40<00:38, 40.06it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████▏    | 1611/3136 [00:40<00:38, 40.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1616/3136 [00:40<00:37, 40.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1621/3136 [00:40<00:37, 40.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1626/3136 [00:40<00:37, 40.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1631/3136 [00:40<00:37, 40.64it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1636/3136 [00:41<00:36, 40.99it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1641/3136 [00:41<00:36, 41.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 1646/3136 [00:41<00:36, 41.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1651/3136 [00:41<00:36, 41.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1656/3136 [00:41<00:36, 40.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1661/3136 [00:41<00:37, 39.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1665/3136 [00:41<00:37, 38.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1669/3136 [00:41<00:39, 37.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1673/3136 [00:42<00:41, 35.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 1677/3136 [00:42<00:39, 36.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▎    | 1681/3136 [00:42<00:39, 37.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▎    | 1685/3136 [00:42<00:38, 37.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▍    | 1690/3136 [00:42<00:37, 38.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▍    | 1695/3136 [00:42<00:36, 39.53it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▍    | 1699/3136 [00:42<00:36, 39.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▍    | 1704/3136 [00:42<00:35, 39.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▍    | 1709/3136 [00:42<00:35, 40.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▍    | 1714/3136 [00:43<00:35, 40.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▍    | 1719/3136 [00:43<00:34, 40.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▍    | 1724/3136 [00:43<00:34, 40.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▌    | 1729/3136 [00:43<00:34, 40.79it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▌    | 1734/3136 [00:43<00:34, 40.88it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▌    | 1739/3136 [00:43<00:34, 40.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▌    | 1744/3136 [00:43<00:34, 40.87it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▌    | 1749/3136 [00:43<00:33, 40.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▌    | 1754/3136 [00:44<00:33, 40.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▌    | 1759/3136 [00:44<00:33, 40.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▋    | 1764/3136 [00:44<00:33, 40.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▋    | 1769/3136 [00:44<00:34, 39.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1773/3136 [00:44<00:34, 39.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1777/3136 [00:44<00:34, 39.03it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1781/3136 [00:44<00:34, 39.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1786/3136 [00:44<00:34, 39.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1791/3136 [00:45<00:33, 39.73it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1795/3136 [00:45<00:33, 39.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 1800/3136 [00:45<00:33, 39.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 1805/3136 [00:45<00:33, 40.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 1810/3136 [00:45<00:32, 40.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 1815/3136 [00:45<00:32, 40.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 1820/3136 [00:45<00:32, 40.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 1825/3136 [00:45<00:32, 40.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 1830/3136 [00:45<00:32, 40.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▊    | 1835/3136 [00:46<00:32, 40.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▊    | 1840/3136 [00:46<00:32, 40.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▉    | 1845/3136 [00:46<00:32, 40.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▉    | 1850/3136 [00:46<00:31, 40.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▉    | 1855/3136 [00:46<00:31, 40.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▉    | 1860/3136 [00:46<00:31, 40.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▉    | 1865/3136 [00:46<00:31, 40.86it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|█████▉    | 1870/3136 [00:46<00:30, 40.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|█████▉    | 1875/3136 [00:47<00:30, 40.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|█████▉    | 1880/3136 [00:47<00:30, 40.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|██████    | 1885/3136 [00:47<00:30, 40.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|██████    | 1890/3136 [00:47<00:30, 41.04it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|██████    | 1895/3136 [00:47<00:30, 41.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████    | 1900/3136 [00:47<00:29, 41.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████    | 1905/3136 [00:47<00:29, 41.40it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████    | 1910/3136 [00:47<00:29, 41.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████    | 1915/3136 [00:48<00:29, 41.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████    | 1920/3136 [00:48<00:29, 41.65it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████▏   | 1925/3136 [00:48<00:29, 41.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 1930/3136 [00:48<00:28, 41.66it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 1935/3136 [00:48<00:29, 41.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 1940/3136 [00:48<00:29, 41.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 1945/3136 [00:48<00:28, 41.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 1950/3136 [00:48<00:28, 41.33it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 1955/3136 [00:49<00:28, 41.40it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▎   | 1960/3136 [00:49<00:28, 41.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 1965/3136 [00:49<00:28, 41.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 1970/3136 [00:49<00:30, 38.85it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 1975/3136 [00:49<00:29, 39.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 1980/3136 [00:49<00:28, 40.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 1985/3136 [00:49<00:29, 39.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 1989/3136 [00:49<00:29, 39.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▎   | 1994/3136 [00:49<00:28, 40.06it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▎   | 1999/3136 [00:50<00:28, 40.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▍   | 2004/3136 [00:50<00:27, 40.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▍   | 2009/3136 [00:50<00:27, 41.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▍   | 2014/3136 [00:50<00:27, 41.33it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▍   | 2019/3136 [00:50<00:26, 41.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▍   | 2024/3136 [00:50<00:26, 41.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▍   | 2029/3136 [00:50<00:26, 41.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▍   | 2034/3136 [00:50<00:26, 41.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▌   | 2039/3136 [00:51<00:26, 41.48it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▌   | 2044/3136 [00:51<00:26, 41.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▌   | 2049/3136 [00:51<00:26, 41.40it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▌   | 2054/3136 [00:51<00:26, 40.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▌   | 2059/3136 [00:51<00:26, 40.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▌   | 2064/3136 [00:51<00:26, 40.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▌   | 2069/3136 [00:51<00:26, 40.67it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▌   | 2074/3136 [00:51<00:25, 41.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▋   | 2079/3136 [00:52<00:25, 41.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▋   | 2084/3136 [00:52<00:25, 41.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 2089/3136 [00:52<00:25, 41.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 2094/3136 [00:52<00:25, 40.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 2099/3136 [00:52<00:25, 41.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 2104/3136 [00:52<00:24, 41.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 2109/3136 [00:52<00:24, 41.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 2114/3136 [00:52<00:24, 41.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 2119/3136 [00:53<00:24, 41.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 2124/3136 [00:53<00:24, 41.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 2129/3136 [00:53<00:24, 41.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 2134/3136 [00:53<00:24, 41.48it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 2139/3136 [00:53<00:24, 41.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 2144/3136 [00:53<00:23, 41.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▊   | 2149/3136 [00:53<00:23, 41.56it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▊   | 2154/3136 [00:53<00:23, 41.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▉   | 2159/3136 [00:53<00:23, 41.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▉   | 2164/3136 [00:54<00:23, 41.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▉   | 2169/3136 [00:54<00:23, 41.13it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▉   | 2174/3136 [00:54<00:23, 41.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▉   | 2179/3136 [00:54<00:23, 41.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|██████▉   | 2184/3136 [00:54<00:23, 40.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|██████▉   | 2189/3136 [00:54<00:23, 40.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|██████▉   | 2194/3136 [00:54<00:23, 40.84it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|███████   | 2199/3136 [00:54<00:22, 40.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|███████   | 2204/3136 [00:55<00:22, 40.79it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|███████   | 2209/3136 [00:55<00:22, 40.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████   | 2214/3136 [00:55<00:22, 40.83it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████   | 2219/3136 [00:55<00:22, 40.79it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████   | 2224/3136 [00:55<00:22, 40.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████   | 2229/3136 [00:55<00:22, 40.57it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████   | 2234/3136 [00:55<00:22, 40.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████▏  | 2239/3136 [00:55<00:22, 40.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 2244/3136 [00:56<00:21, 40.72it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 2249/3136 [00:56<00:21, 40.82it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 2254/3136 [00:56<00:21, 41.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 2259/3136 [00:56<00:21, 41.36it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 2264/3136 [00:56<00:21, 41.31it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 2269/3136 [00:56<00:21, 41.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2274/3136 [00:56<00:20, 41.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2279/3136 [00:56<00:20, 41.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2284/3136 [00:57<00:20, 41.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2289/3136 [00:57<00:20, 41.48it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2294/3136 [00:57<00:20, 41.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2299/3136 [00:57<00:20, 41.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 2304/3136 [00:57<00:19, 41.79it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▎  | 2309/3136 [00:57<00:19, 41.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▍  | 2314/3136 [00:57<00:19, 41.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▍  | 2319/3136 [00:57<00:19, 42.06it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▍  | 2324/3136 [00:57<00:19, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▍  | 2329/3136 [00:58<00:19, 42.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▍  | 2334/3136 [00:58<00:19, 42.03it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▍  | 2339/3136 [00:58<00:18, 42.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▍  | 2344/3136 [00:58<00:18, 42.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▍  | 2349/3136 [00:58<00:18, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▌  | 2354/3136 [00:58<00:18, 42.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▌  | 2359/3136 [00:58<00:18, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▌  | 2364/3136 [00:58<00:18, 42.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▌  | 2369/3136 [00:59<00:18, 41.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▌  | 2374/3136 [00:59<00:18, 42.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▌  | 2379/3136 [00:59<00:17, 42.10it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▌  | 2384/3136 [00:59<00:17, 42.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▌  | 2389/3136 [00:59<00:17, 42.21it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▋  | 2394/3136 [00:59<00:17, 41.93it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▋  | 2399/3136 [00:59<00:17, 41.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 2404/3136 [00:59<00:17, 41.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 2409/3136 [01:00<00:17, 41.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 2414/3136 [01:00<00:17, 41.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 2419/3136 [01:00<00:17, 41.66it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 2424/3136 [01:00<00:16, 41.90it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 2429/3136 [01:00<00:16, 42.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 2434/3136 [01:00<00:16, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 2439/3136 [01:00<00:16, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 2444/3136 [01:00<00:16, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 2449/3136 [01:00<00:16, 41.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 2454/3136 [01:01<00:16, 41.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 2459/3136 [01:01<00:16, 41.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▊  | 2464/3136 [01:01<00:15, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▊  | 2469/3136 [01:01<00:15, 42.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▉  | 2474/3136 [01:01<00:15, 41.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▉  | 2479/3136 [01:01<00:15, 42.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▉  | 2484/3136 [01:01<00:15, 42.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▉  | 2489/3136 [01:01<00:15, 41.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|███████▉  | 2494/3136 [01:02<00:15, 40.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|███████▉  | 2499/3136 [01:02<00:15, 40.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|███████▉  | 2504/3136 [01:02<00:15, 41.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|████████  | 2509/3136 [01:02<00:15, 41.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|████████  | 2514/3136 [01:02<00:15, 41.27it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|████████  | 2519/3136 [01:02<00:14, 41.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|████████  | 2524/3136 [01:02<00:14, 41.67it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████  | 2529/3136 [01:02<00:14, 41.72it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████  | 2534/3136 [01:03<00:14, 41.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████  | 2539/3136 [01:03<00:14, 41.93it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████  | 2544/3136 [01:03<00:14, 42.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████▏ | 2549/3136 [01:03<00:13, 42.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████▏ | 2554/3136 [01:03<00:13, 42.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 2559/3136 [01:03<00:13, 42.27it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 2564/3136 [01:03<00:13, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 2569/3136 [01:03<00:13, 42.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 2574/3136 [01:03<00:13, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 2579/3136 [01:04<00:13, 42.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 2584/3136 [01:04<00:13, 42.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 2589/3136 [01:04<00:12, 42.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 2594/3136 [01:04<00:12, 42.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 2599/3136 [01:04<00:12, 42.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 2604/3136 [01:04<00:12, 42.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 2609/3136 [01:04<00:12, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 2614/3136 [01:04<00:12, 42.35it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▎ | 2619/3136 [01:05<00:12, 42.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▎ | 2624/3136 [01:05<00:12, 42.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▍ | 2629/3136 [01:05<00:11, 42.27it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▍ | 2634/3136 [01:05<00:11, 42.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▍ | 2639/3136 [01:05<00:11, 42.36it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▍ | 2644/3136 [01:05<00:11, 42.20it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▍ | 2649/3136 [01:05<00:11, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▍ | 2654/3136 [01:05<00:11, 42.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▍ | 2659/3136 [01:05<00:11, 42.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▍ | 2664/3136 [01:06<00:11, 42.33it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▌ | 2669/3136 [01:06<00:11, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▌ | 2674/3136 [01:06<00:10, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▌ | 2679/3136 [01:06<00:10, 42.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▌ | 2684/3136 [01:06<00:10, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▌ | 2689/3136 [01:06<00:10, 41.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▌ | 2694/3136 [01:06<00:10, 41.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▌ | 2699/3136 [01:06<00:10, 42.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▌ | 2704/3136 [01:07<00:10, 42.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▋ | 2709/3136 [01:07<00:10, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 2714/3136 [01:07<00:09, 42.34it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 2719/3136 [01:07<00:09, 42.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 2724/3136 [01:07<00:09, 42.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 2729/3136 [01:07<00:09, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 2734/3136 [01:07<00:09, 42.31it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 2739/3136 [01:07<00:09, 42.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2744/3136 [01:07<00:09, 42.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2749/3136 [01:08<00:09, 42.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2754/3136 [01:08<00:09, 41.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2759/3136 [01:08<00:08, 42.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2764/3136 [01:08<00:08, 42.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2769/3136 [01:08<00:08, 42.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 2774/3136 [01:08<00:08, 42.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▊ | 2779/3136 [01:08<00:08, 42.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▉ | 2784/3136 [01:08<00:08, 42.28it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▉ | 2789/3136 [01:09<00:08, 42.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▉ | 2794/3136 [01:09<00:08, 42.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▉ | 2799/3136 [01:09<00:08, 41.99it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▉ | 2804/3136 [01:09<00:07, 42.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|████████▉ | 2809/3136 [01:09<00:07, 42.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|████████▉ | 2814/3136 [01:09<00:07, 42.10it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|████████▉ | 2819/3136 [01:09<00:07, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|█████████ | 2824/3136 [01:09<00:07, 42.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|█████████ | 2829/3136 [01:09<00:07, 42.17it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|█████████ | 2834/3136 [01:10<00:07, 42.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████ | 2839/3136 [01:10<00:07, 42.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████ | 2844/3136 [01:10<00:06, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████ | 2849/3136 [01:10<00:06, 42.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████ | 2854/3136 [01:10<00:06, 42.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████ | 2859/3136 [01:10<00:06, 42.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████▏| 2864/3136 [01:10<00:06, 42.57it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████▏| 2869/3136 [01:10<00:06, 42.61it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 2874/3136 [01:11<00:06, 42.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 2879/3136 [01:11<00:06, 42.64it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 2884/3136 [01:11<00:05, 42.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 2889/3136 [01:11<00:05, 42.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 2894/3136 [01:11<00:05, 42.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 2899/3136 [01:11<00:05, 42.62it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 2904/3136 [01:11<00:05, 42.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 2909/3136 [01:11<00:05, 42.72it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 2914/3136 [01:11<00:05, 42.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 2919/3136 [01:12<00:05, 42.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 2924/3136 [01:12<00:05, 42.06it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 2929/3136 [01:12<00:05, 41.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▎| 2934/3136 [01:12<00:04, 41.46it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▎| 2939/3136 [01:12<00:04, 41.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▍| 2944/3136 [01:12<00:04, 42.03it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▍| 2949/3136 [01:12<00:04, 42.19it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▍| 2954/3136 [01:12<00:04, 42.33it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▍| 2959/3136 [01:13<00:04, 42.48it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▍| 2964/3136 [01:13<00:04, 42.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▍| 2969/3136 [01:13<00:03, 42.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▍| 2974/3136 [01:13<00:03, 42.47it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▍| 2979/3136 [01:13<00:03, 42.36it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▌| 2984/3136 [01:13<00:03, 42.40it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▌| 2989/3136 [01:13<00:03, 42.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▌| 2994/3136 [01:13<00:03, 42.27it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▌| 2999/3136 [01:14<00:03, 42.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▌| 3004/3136 [01:14<00:03, 42.16it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▌| 3009/3136 [01:14<00:03, 42.23it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▌| 3014/3136 [01:14<00:02, 42.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▋| 3019/3136 [01:14<00:02, 42.44it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▋| 3024/3136 [01:14<00:02, 42.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 3029/3136 [01:14<00:02, 42.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 3034/3136 [01:14<00:02, 42.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 3039/3136 [01:14<00:02, 42.52it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 3044/3136 [01:15<00:02, 42.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 3049/3136 [01:15<00:02, 42.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 3054/3136 [01:15<00:01, 42.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 3059/3136 [01:15<00:01, 42.84it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 3064/3136 [01:15<00:01, 42.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 3069/3136 [01:15<00:01, 42.65it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 3074/3136 [01:15<00:01, 42.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 3079/3136 [01:15<00:01, 42.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 3084/3136 [01:16<00:01, 42.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▊| 3089/3136 [01:16<00:01, 42.64it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▊| 3094/3136 [01:16<00:00, 42.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▉| 3099/3136 [01:16<00:00, 42.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▉| 3104/3136 [01:16<00:00, 42.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▉| 3109/3136 [01:16<00:00, 42.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▉| 3114/3136 [01:16<00:00, 42.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▉| 3119/3136 [01:16<00:00, 41.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r100%|█████████▉| 3124/3136 [01:16<00:00, 42.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r100%|█████████▉| 3129/3136 [01:17<00:00, 42.32it/s]"},{"output_type":"stream","name":"stderr","text":"\r100%|█████████▉| 3134/3136 [01:17<00:00, 42.17it/s]"},{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 3136/3136 [01:17<00:00, 40.60it/s]"},{"output_type":"stream","name":"stderr","text":"\n"}],"key":"vTdCM9NR1a"}],"key":"vPdwtQa7tn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dem_reconst.isel(band=0).plot.imshow(cmap=\"terrain\")","key":"cbYGoOWzjz"},{"type":"output","id":"sypLZzi6BzKW9F-Dr8Lot","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2a5cb7e9124d5db25c92b56742247cfb","path":"/xbatcher-deep-learning/build/2a5cb7e9124d5db25c92b56742247cfb.png"}}}],"key":"wtXLiwPris"}],"key":"AOk3v75f9f"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"That certainly looks like the original DEM. Let’s try plotting the error in the reconstruction.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XTXZeY4lKn"}],"key":"xD8GLui2S1"}],"key":"kdjnicBN9R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"err = (dem_reconst - dem)\nerr.isel(band=0).plot.imshow()\nplt.show()","key":"SvbtNbnI6G"},{"type":"output","id":"TfEKLrUbnSw6qfDEOmTcT","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b6f853c297158cf8f37a8d18d3b4e008","path":"/xbatcher-deep-learning/build/b6f853c297158cf8f37a8d18d3b4e008.png"}}}],"key":"xuuAl8Uh1F"}],"key":"Or6eYRQakY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"err.plot.hist()\nplt.show()","key":"EIeNzYfiit"},{"type":"output","id":"DCWl7WYBeULwiHCSOn8n6","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"56c5c7f2a7bead19629021e6e1221c26","path":"/xbatcher-deep-learning/build/56c5c7f2a7bead19629021e6e1221c26.png"}}}],"key":"XVkXRuwubU"}],"key":"EhuZQym8Mb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Not bad!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aLJpcBUGSl"}],"key":"lLDW14EKA7"}],"key":"MbL1KxqTo0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reconstruction 2: Getting the latent dimension","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B48SfBFXbZ"}],"identifier":"reconstruction-2-getting-the-latent-dimension","label":"Reconstruction 2: Getting the latent dimension","html_id":"reconstruction-2-getting-the-latent-dimension","implicit":true,"key":"oWi2Wpy3QI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A common application of autoencoders is to use the latent dimension for some application. Let’s turn our autoencoder’s predictions into a data cube. To do so we will modify the batch generator to not have overlapping windows. We also have to slightly clip the size of the input DEM. This is because we are effectively downscaling the spatial axes by a factor of 32. Since ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W2B7MzLO4M"},{"type":"inlineCode","value":"3600 / 32","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yc6CorL6cD"},{"type":"text","value":" is not an integer, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qRpBPCVTaw"},{"type":"inlineCode","value":"predict_on_array","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"efRVdt31g8"},{"type":"text","value":" will not know how to rescale the array size. So, we have to clip the DEM to the nearest integer multiple of 32. In this case the nearest multiple is 3584, which we achieve by clipping 8 pixels from each side.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Fup2cfCgjY"}],"key":"VhLDyieAPI"}],"key":"hd4dZlBx8t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bgen_no_overlap = xbatcher.BatchGenerator(\n    dem.isel(x=slice(8, -8), y=slice(8, -8)),\n    input_dims=dict(x=32, y=32),\n    input_overlap=dict(x=0, y=0)\n)\n\nds_no_overlap = MapDataset(\n    X_generator=bgen_no_overlap\n)\n\nloader = torch.utils.data.DataLoader(ds_no_overlap, batch_size=16, shuffle=True)\n\nex_input = next(iter(loader))\n\n# Same as before\nprint(\"Input shape:\", ex_input.shape)","key":"cGNdEKL3v5"},{"type":"output","id":"64jCnwljace-OjlC_Tg1Q","data":[{"output_type":"stream","name":"stdout","text":"Input shape: torch.Size([16, 1, 32, 32])\n"}],"key":"K8uQ5bnduo"}],"key":"KywRsKZVOf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we will write a function that the calls the encoder arm of the autoencoder and adds a fake x and y dimension.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FS771Mp09m"}],"key":"FYbcGCV94q"}],"key":"bMmr96jNMO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def infer_with_encoder(x):\n    return m.encoder(x)[:, None, None, :]\n\nex_output = infer_with_encoder(ex_input)\nprint(\"Output shape:\", ex_output.shape)","key":"bN32e3TMkr"},{"type":"output","id":"oFodLTp3-dP615X6f5-_R","data":[{"output_type":"stream","name":"stdout","text":"Output shape: torch.Size([16, 1, 1, 64])\n"}],"key":"Wen2ShuifP"}],"key":"yJ2NPNd2Lj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To be clear, we started with the usual x/y/band tensor from the input dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g5C2K0mdNY"}],"key":"D1nWNFeNJs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"comment","value":" Horizontal lines ","key":"BqBdYv1I77"},{"type":"comment","value":" Vertical lines ","key":"MH8s3U1zWu"},{"type":"comment","value":" Colored Rectangle ","key":"YDq4BSm16N"},{"type":"comment","value":" Horizontal lines ","key":"Qp545vQ8W9"},{"type":"comment","value":" Vertical lines ","key":"e6SU01l7MC"},{"type":"comment","value":" Colored Rectangle ","key":"MHtWV1OQFu"},{"type":"comment","value":" Horizontal lines ","key":"YtjykwdJfE"},{"type":"comment","value":" Vertical lines ","key":"IfALJjd0hN"},{"type":"comment","value":" Colored Rectangle ","key":"pGlH0xG8e4"},{"type":"comment","value":" Text ","key":"gu00k9Iidq"}],"key":"mpaGS8G5VM"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"...and end up with a tensor that has singleton x/y dimensions and a new, 64-element channel dimension.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"AtW94bQmoU"}],"key":"XeGHCP1I5X"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"comment","value":" Horizontal lines ","key":"bJ3c2DcFQG"},{"type":"comment","value":" Vertical lines ","key":"Sz4jevoJS0"},{"type":"comment","value":" Colored Rectangle ","key":"neW0Za1Axy"},{"type":"comment","value":" Horizontal lines ","key":"gDS2dxF9Q2"},{"type":"comment","value":" Vertical lines ","key":"tJXJsaqMY9"},{"type":"comment","value":" Colored Rectangle ","key":"iVtXnJsMc6"},{"type":"comment","value":" Horizontal lines ","key":"FfioEJYHSg"},{"type":"comment","value":" Vertical lines ","key":"RqagG9PyCI"},{"type":"comment","value":" Colored Rectangle ","key":"Heh5IdV9hv"},{"type":"comment","value":" Text ","key":"QKWtyrwIeW"}],"key":"j5ABwDt9sR"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"We can go through the same process as before to see how we put together the ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"c1IfO732JV"},{"type":"inlineCode","value":"predict_on_array","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"CNuDkDNM2Q"},{"type":"text","value":" call. Both the ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"VxgpOwlc5N"},{"type":"inlineCode","value":"x","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"uILVKhYOlJ"},{"type":"text","value":" and ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"YokQjrkOrM"},{"type":"inlineCode","value":"y","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"xQGeREUo8r"},{"type":"text","value":" dimensions change size and are used by the batch generator, so they go in ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"UURZys52Ng"},{"type":"inlineCode","value":"resample_dims","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"yrH3Q8mMt1"},{"type":"text","value":". The remaining dimension, ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"PN2hGP8ATm"},{"type":"inlineCode","value":"channel","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"qVFVz3ZJpq"},{"type":"text","value":", is a new dimension and goes in the ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"ezuyvBxCHH"},{"type":"inlineCode","value":"new_dim","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"AD3hFACUpA"},{"type":"text","value":" list.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"IwUwFHEvSB"}],"key":"MfRMCjwE01"}],"key":"sPPI8fJ6I0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"latent_dim_cube = functions.predict_on_array(\n    dataset=ds_no_overlap,\n    model=infer_with_encoder,\n    output_tensor_dim=dict(y=1, x=1, channel=64),\n    new_dim=[\"channel\"],\n    core_dim=[],\n    resample_dim=[\"x\", \"y\"]\n)","key":"DsrT3hK7CI"},{"type":"output","id":"gosv9K8PrRLYvdtdH44cq","data":[{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/784 [00:00<?, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\r  1%|          | 7/784 [00:00<00:12, 63.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r  2%|▏         | 14/784 [00:00<00:12, 63.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r  3%|▎         | 21/784 [00:00<00:11, 63.97it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▎         | 28/784 [00:00<00:11, 63.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r  4%|▍         | 35/784 [00:00<00:11, 63.91it/s]"},{"output_type":"stream","name":"stderr","text":"\r  5%|▌         | 42/784 [00:00<00:11, 63.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r  6%|▋         | 49/784 [00:00<00:11, 64.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r  7%|▋         | 56/784 [00:00<00:11, 64.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r  8%|▊         | 63/784 [00:00<00:11, 64.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r  9%|▉         | 70/784 [00:01<00:11, 61.11it/s]"},{"output_type":"stream","name":"stderr","text":"\r 10%|▉         | 77/784 [00:01<00:11, 61.13it/s]"},{"output_type":"stream","name":"stderr","text":"\r 11%|█         | 84/784 [00:01<00:11, 61.74it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▏        | 91/784 [00:01<00:11, 62.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 12%|█▎        | 98/784 [00:01<00:10, 62.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 13%|█▎        | 105/784 [00:01<00:10, 63.00it/s]"},{"output_type":"stream","name":"stderr","text":"\r 14%|█▍        | 112/784 [00:01<00:10, 63.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 15%|█▌        | 119/784 [00:01<00:10, 62.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r 16%|█▌        | 126/784 [00:01<00:10, 63.60it/s]"},{"output_type":"stream","name":"stderr","text":"\r 17%|█▋        | 133/784 [00:02<00:10, 63.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 18%|█▊        | 140/784 [00:02<00:10, 63.69it/s]"},{"output_type":"stream","name":"stderr","text":"\r 19%|█▉        | 147/784 [00:02<00:09, 63.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 20%|█▉        | 154/784 [00:02<00:09, 63.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██        | 161/784 [00:02<00:09, 64.03it/s]"},{"output_type":"stream","name":"stderr","text":"\r 21%|██▏       | 168/784 [00:02<00:09, 64.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r 22%|██▏       | 175/784 [00:02<00:09, 64.41it/s]"},{"output_type":"stream","name":"stderr","text":"\r 23%|██▎       | 182/784 [00:02<00:09, 64.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 24%|██▍       | 189/784 [00:02<00:09, 64.12it/s]"},{"output_type":"stream","name":"stderr","text":"\r 25%|██▌       | 196/784 [00:03<00:09, 64.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 26%|██▌       | 203/784 [00:03<00:09, 63.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 27%|██▋       | 210/784 [00:03<00:08, 63.80it/s]"},{"output_type":"stream","name":"stderr","text":"\r 28%|██▊       | 217/784 [00:03<00:08, 63.66it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▊       | 224/784 [00:03<00:08, 63.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 29%|██▉       | 231/784 [00:03<00:08, 64.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 30%|███       | 238/784 [00:03<00:08, 64.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 31%|███▏      | 245/784 [00:03<00:08, 64.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 32%|███▏      | 252/784 [00:03<00:08, 64.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 33%|███▎      | 259/784 [00:04<00:08, 64.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r 34%|███▍      | 266/784 [00:04<00:08, 64.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 35%|███▍      | 273/784 [00:04<00:07, 64.15it/s]"},{"output_type":"stream","name":"stderr","text":"\r 36%|███▌      | 280/784 [00:04<00:07, 63.77it/s]"},{"output_type":"stream","name":"stderr","text":"\r 37%|███▋      | 287/784 [00:04<00:07, 63.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 294/784 [00:04<00:07, 63.95it/s]"},{"output_type":"stream","name":"stderr","text":"\r 38%|███▊      | 301/784 [00:04<00:07, 64.01it/s]"},{"output_type":"stream","name":"stderr","text":"\r 39%|███▉      | 308/784 [00:04<00:07, 63.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r 40%|████      | 315/784 [00:04<00:07, 63.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 41%|████      | 322/784 [00:05<00:07, 63.75it/s]"},{"output_type":"stream","name":"stderr","text":"\r 42%|████▏     | 329/784 [00:05<00:07, 63.64it/s]"},{"output_type":"stream","name":"stderr","text":"\r 43%|████▎     | 336/784 [00:05<00:07, 63.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r 44%|████▍     | 343/784 [00:05<00:06, 63.38it/s]"},{"output_type":"stream","name":"stderr","text":"\r 45%|████▍     | 350/784 [00:05<00:06, 63.63it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▌     | 357/784 [00:05<00:06, 63.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 46%|████▋     | 364/784 [00:05<00:06, 63.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 47%|████▋     | 371/784 [00:05<00:06, 63.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 48%|████▊     | 378/784 [00:05<00:06, 63.59it/s]"},{"output_type":"stream","name":"stderr","text":"\r 49%|████▉     | 385/784 [00:06<00:06, 63.67it/s]"},{"output_type":"stream","name":"stderr","text":"\r 50%|█████     | 392/784 [00:06<00:06, 64.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 51%|█████     | 399/784 [00:06<00:05, 64.25it/s]"},{"output_type":"stream","name":"stderr","text":"\r 52%|█████▏    | 406/784 [00:06<00:05, 63.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r 53%|█████▎    | 413/784 [00:06<00:05, 63.66it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▎    | 420/784 [00:06<00:05, 64.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 54%|█████▍    | 427/784 [00:06<00:05, 64.30it/s]"},{"output_type":"stream","name":"stderr","text":"\r 55%|█████▌    | 434/784 [00:06<00:05, 64.37it/s]"},{"output_type":"stream","name":"stderr","text":"\r 56%|█████▋    | 441/784 [00:06<00:05, 64.07it/s]"},{"output_type":"stream","name":"stderr","text":"\r 57%|█████▋    | 448/784 [00:07<00:05, 63.73it/s]"},{"output_type":"stream","name":"stderr","text":"\r 58%|█████▊    | 455/784 [00:07<00:05, 63.70it/s]"},{"output_type":"stream","name":"stderr","text":"\r 59%|█████▉    | 462/784 [00:07<00:05, 63.49it/s]"},{"output_type":"stream","name":"stderr","text":"\r 60%|█████▉    | 469/784 [00:07<00:05, 62.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 61%|██████    | 476/784 [00:07<00:04, 61.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▏   | 483/784 [00:07<00:04, 61.85it/s]"},{"output_type":"stream","name":"stderr","text":"\r 62%|██████▎   | 490/784 [00:07<00:04, 62.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 63%|██████▎   | 497/784 [00:07<00:04, 63.05it/s]"},{"output_type":"stream","name":"stderr","text":"\r 64%|██████▍   | 504/784 [00:07<00:04, 63.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 65%|██████▌   | 511/784 [00:08<00:04, 63.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 66%|██████▌   | 518/784 [00:08<00:04, 63.89it/s]"},{"output_type":"stream","name":"stderr","text":"\r 67%|██████▋   | 525/784 [00:08<00:04, 63.91it/s]"},{"output_type":"stream","name":"stderr","text":"\r 68%|██████▊   | 532/784 [00:08<00:03, 63.98it/s]"},{"output_type":"stream","name":"stderr","text":"\r 69%|██████▉   | 539/784 [00:08<00:03, 63.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r 70%|██████▉   | 546/784 [00:08<00:03, 63.94it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████   | 553/784 [00:08<00:03, 64.14it/s]"},{"output_type":"stream","name":"stderr","text":"\r 71%|███████▏  | 560/784 [00:08<00:03, 64.29it/s]"},{"output_type":"stream","name":"stderr","text":"\r 72%|███████▏  | 567/784 [00:08<00:03, 64.26it/s]"},{"output_type":"stream","name":"stderr","text":"\r 73%|███████▎  | 574/784 [00:09<00:03, 64.22it/s]"},{"output_type":"stream","name":"stderr","text":"\r 74%|███████▍  | 581/784 [00:09<00:03, 64.02it/s]"},{"output_type":"stream","name":"stderr","text":"\r 75%|███████▌  | 588/784 [00:09<00:03, 63.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 76%|███████▌  | 595/784 [00:09<00:02, 63.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 77%|███████▋  | 602/784 [00:09<00:02, 63.08it/s]"},{"output_type":"stream","name":"stderr","text":"\r 78%|███████▊  | 609/784 [00:09<00:02, 63.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▊  | 616/784 [00:09<00:02, 63.78it/s]"},{"output_type":"stream","name":"stderr","text":"\r 79%|███████▉  | 623/784 [00:09<00:02, 63.68it/s]"},{"output_type":"stream","name":"stderr","text":"\r 80%|████████  | 630/784 [00:09<00:02, 63.45it/s]"},{"output_type":"stream","name":"stderr","text":"\r 81%|████████▏ | 637/784 [00:10<00:02, 63.42it/s]"},{"output_type":"stream","name":"stderr","text":"\r 82%|████████▏ | 644/784 [00:10<00:02, 63.66it/s]"},{"output_type":"stream","name":"stderr","text":"\r 83%|████████▎ | 651/784 [00:10<00:02, 63.81it/s]"},{"output_type":"stream","name":"stderr","text":"\r 84%|████████▍ | 658/784 [00:10<00:01, 63.65it/s]"},{"output_type":"stream","name":"stderr","text":"\r 85%|████████▍ | 665/784 [00:10<00:01, 63.55it/s]"},{"output_type":"stream","name":"stderr","text":"\r 86%|████████▌ | 672/784 [00:10<00:01, 63.90it/s]"},{"output_type":"stream","name":"stderr","text":"\r 87%|████████▋ | 679/784 [00:10<00:01, 63.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 686/784 [00:10<00:01, 64.18it/s]"},{"output_type":"stream","name":"stderr","text":"\r 88%|████████▊ | 693/784 [00:10<00:01, 63.92it/s]"},{"output_type":"stream","name":"stderr","text":"\r 89%|████████▉ | 700/784 [00:10<00:01, 63.80it/s]"},{"output_type":"stream","name":"stderr","text":"\r 90%|█████████ | 707/784 [00:11<00:01, 63.65it/s]"},{"output_type":"stream","name":"stderr","text":"\r 91%|█████████ | 714/784 [00:11<00:01, 63.54it/s]"},{"output_type":"stream","name":"stderr","text":"\r 92%|█████████▏| 721/784 [00:11<00:00, 63.71it/s]"},{"output_type":"stream","name":"stderr","text":"\r 93%|█████████▎| 728/784 [00:11<00:00, 63.43it/s]"},{"output_type":"stream","name":"stderr","text":"\r 94%|█████████▍| 735/784 [00:11<00:00, 63.24it/s]"},{"output_type":"stream","name":"stderr","text":"\r 95%|█████████▍| 742/784 [00:11<00:00, 63.50it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▌| 749/784 [00:11<00:00, 63.58it/s]"},{"output_type":"stream","name":"stderr","text":"\r 96%|█████████▋| 756/784 [00:11<00:00, 63.09it/s]"},{"output_type":"stream","name":"stderr","text":"\r 97%|█████████▋| 763/784 [00:11<00:00, 63.51it/s]"},{"output_type":"stream","name":"stderr","text":"\r 98%|█████████▊| 770/784 [00:12<00:00, 63.75it/s]"},{"output_type":"stream","name":"stderr","text":"\r 99%|█████████▉| 777/784 [00:12<00:00, 63.88it/s]"},{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 784/784 [00:12<00:00, 63.76it/s]"},{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 784/784 [00:12<00:00, 63.64it/s]"},{"output_type":"stream","name":"stderr","text":"\n"}],"key":"AIy9BWPklY"}],"key":"hTFPK1BTpR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"latent_dim_cube","key":"PqbrW2C70I"},{"type":"output","id":"UmKwJvVsO0F9c2T98wutH","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"<xarray.DataArray (y: 112, x: 112, channel: 64)> Size: 6MB\narray([[[-2.98959292e-01,  1.64430934e-01,  1.15438255e-02, ...,\n         -8.08710732e-03,  3.30118317e-02, -5.46855937e-04],\n        [-2.24567760e-03,  9.47532182e-02, -3.34303832e-02, ...,\n         -6.48077535e-03,  8.64085204e-04, -1.95042637e-02],\n        [-2.29584158e-02, -1.93482539e-01, -2.64102204e-02, ...,\n         -5.21691757e-02, -2.33358999e-03, -1.43376856e-03],\n        ...,\n        [-7.14939087e-01,  3.34519677e-02, -1.22026729e-01, ...,\n         -4.24666117e-02,  1.09958167e-01, -2.81837341e-02],\n        [-1.44703043e+00, -6.82025516e-03, -1.32837495e-01, ...,\n          1.01037129e-01,  1.24011525e-01,  2.93925781e-02],\n        [-1.88280569e+00,  1.58894039e-01,  1.94406669e-01, ...,\n          2.02963516e-01, -1.02580176e-01, -2.27122382e-02]],\n\n       [[-3.11284028e-01,  4.57395907e-02, -5.93765944e-02, ...,\n          9.89407912e-02,  6.95664992e-03, -2.08061733e-02],\n        [-8.16732126e-02,  2.07674481e-01,  5.54563779e-02, ...,\n         -3.88096709e-02,  3.14765790e-02, -7.57243798e-04],\n        [-1.09194994e-01, -5.78870165e-03,  8.61930280e-02, ...,\n          2.35724309e-02,  4.35084485e-02,  6.65596484e-04],\n...\n         -1.84319850e-01,  5.72853962e-02,  1.05324888e-01],\n        [-2.57522762e+00,  4.06043765e-01,  2.18213096e-01, ...,\n          2.16262191e-01,  2.44147664e-01, -2.79635558e-02],\n        [-4.53882925e+00, -3.61320565e-01,  9.88348282e-02, ...,\n         -9.99270161e-02, -1.89315409e-01,  7.27320120e-02]],\n\n       [[-5.32383745e+00, -2.59905275e-01, -9.42536151e-02, ...,\n         -1.14359197e-01, -7.32243057e-02, -1.17779599e-01],\n        [-4.61458548e+00, -3.59844762e-01,  1.96055190e-01, ...,\n         -9.51545225e-02, -2.07306574e-01, -1.21820868e-01],\n        [-4.43024026e+00, -1.50307160e-01, -2.68508102e-01, ...,\n          2.49489361e-02, -2.64294322e-01, -1.70129536e-02],\n        ...,\n        [-1.79788969e+00, -4.62374302e-01,  3.78449074e-02, ...,\n         -1.45970427e-01, -1.10146726e-01, -3.16941288e-02],\n        [-1.89689242e+00,  1.96203432e-01,  1.83354633e-02, ...,\n         -1.92172321e-01,  7.78421414e-02, -5.74109845e-02],\n        [-4.11928259e+00, -7.79838400e-01, -1.65173175e-01, ...,\n          1.25174990e-01, -2.02087485e-01, -2.00104178e-02]]],\n      shape=(112, 112, 64))\nCoordinates:\n  * y        (y) float64 896B 48.0 47.99 47.98 47.97 ... 47.04 47.03 47.02 47.01\n  * x        (x) float64 896B -124.0 -124.0 -124.0 ... -123.0 -123.0 -123.0\nDimensions without coordinates: channel","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 112, x: 112, channel: 64)&gt; Size: 6MB\narray([[[-2.98959292e-01,  1.64430934e-01,  1.15438255e-02, ...,\n         -8.08710732e-03,  3.30118317e-02, -5.46855937e-04],\n        [-2.24567760e-03,  9.47532182e-02, -3.34303832e-02, ...,\n         -6.48077535e-03,  8.64085204e-04, -1.95042637e-02],\n        [-2.29584158e-02, -1.93482539e-01, -2.64102204e-02, ...,\n         -5.21691757e-02, -2.33358999e-03, -1.43376856e-03],\n        ...,\n        [-7.14939087e-01,  3.34519677e-02, -1.22026729e-01, ...,\n         -4.24666117e-02,  1.09958167e-01, -2.81837341e-02],\n        [-1.44703043e+00, -6.82025516e-03, -1.32837495e-01, ...,\n          1.01037129e-01,  1.24011525e-01,  2.93925781e-02],\n        [-1.88280569e+00,  1.58894039e-01,  1.94406669e-01, ...,\n          2.02963516e-01, -1.02580176e-01, -2.27122382e-02]],\n\n       [[-3.11284028e-01,  4.57395907e-02, -5.93765944e-02, ...,\n          9.89407912e-02,  6.95664992e-03, -2.08061733e-02],\n        [-8.16732126e-02,  2.07674481e-01,  5.54563779e-02, ...,\n         -3.88096709e-02,  3.14765790e-02, -7.57243798e-04],\n        [-1.09194994e-01, -5.78870165e-03,  8.61930280e-02, ...,\n          2.35724309e-02,  4.35084485e-02,  6.65596484e-04],\n...\n         -1.84319850e-01,  5.72853962e-02,  1.05324888e-01],\n        [-2.57522762e+00,  4.06043765e-01,  2.18213096e-01, ...,\n          2.16262191e-01,  2.44147664e-01, -2.79635558e-02],\n        [-4.53882925e+00, -3.61320565e-01,  9.88348282e-02, ...,\n         -9.99270161e-02, -1.89315409e-01,  7.27320120e-02]],\n\n       [[-5.32383745e+00, -2.59905275e-01, -9.42536151e-02, ...,\n         -1.14359197e-01, -7.32243057e-02, -1.17779599e-01],\n        [-4.61458548e+00, -3.59844762e-01,  1.96055190e-01, ...,\n         -9.51545225e-02, -2.07306574e-01, -1.21820868e-01],\n        [-4.43024026e+00, -1.50307160e-01, -2.68508102e-01, ...,\n          2.49489361e-02, -2.64294322e-01, -1.70129536e-02],\n        ...,\n        [-1.79788969e+00, -4.62374302e-01,  3.78449074e-02, ...,\n         -1.45970427e-01, -1.10146726e-01, -3.16941288e-02],\n        [-1.89689242e+00,  1.96203432e-01,  1.83354633e-02, ...,\n         -1.92172321e-01,  7.78421414e-02, -5.74109845e-02],\n        [-4.11928259e+00, -7.79838400e-01, -1.65173175e-01, ...,\n          1.25174990e-01, -2.02087485e-01, -2.00104178e-02]]],\n      shape=(112, 112, 64))\nCoordinates:\n  * y        (y) float64 896B 48.0 47.99 47.98 47.97 ... 47.04 47.03 47.02 47.01\n  * x        (x) float64 896B -124.0 -124.0 -124.0 ... -123.0 -123.0 -123.0\nDimensions without coordinates: channel</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 112</li><li><span class='xr-has-index'>x</span>: 112</li><li><span>channel</span>: 64</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9a5e0eb4-9de1-42e7-af9e-a17c78041d0a' class='xr-array-in' type='checkbox' checked><label for='section-9a5e0eb4-9de1-42e7-af9e-a17c78041d0a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.299 0.1644 0.01154 0.05633 ... 4.882 0.1252 -0.2021 -0.02001</span></div><div class='xr-array-data'><pre>array([[[-2.98959292e-01,  1.64430934e-01,  1.15438255e-02, ...,\n         -8.08710732e-03,  3.30118317e-02, -5.46855937e-04],\n        [-2.24567760e-03,  9.47532182e-02, -3.34303832e-02, ...,\n         -6.48077535e-03,  8.64085204e-04, -1.95042637e-02],\n        [-2.29584158e-02, -1.93482539e-01, -2.64102204e-02, ...,\n         -5.21691757e-02, -2.33358999e-03, -1.43376856e-03],\n        ...,\n        [-7.14939087e-01,  3.34519677e-02, -1.22026729e-01, ...,\n         -4.24666117e-02,  1.09958167e-01, -2.81837341e-02],\n        [-1.44703043e+00, -6.82025516e-03, -1.32837495e-01, ...,\n          1.01037129e-01,  1.24011525e-01,  2.93925781e-02],\n        [-1.88280569e+00,  1.58894039e-01,  1.94406669e-01, ...,\n          2.02963516e-01, -1.02580176e-01, -2.27122382e-02]],\n\n       [[-3.11284028e-01,  4.57395907e-02, -5.93765944e-02, ...,\n          9.89407912e-02,  6.95664992e-03, -2.08061733e-02],\n        [-8.16732126e-02,  2.07674481e-01,  5.54563779e-02, ...,\n         -3.88096709e-02,  3.14765790e-02, -7.57243798e-04],\n        [-1.09194994e-01, -5.78870165e-03,  8.61930280e-02, ...,\n          2.35724309e-02,  4.35084485e-02,  6.65596484e-04],\n...\n         -1.84319850e-01,  5.72853962e-02,  1.05324888e-01],\n        [-2.57522762e+00,  4.06043765e-01,  2.18213096e-01, ...,\n          2.16262191e-01,  2.44147664e-01, -2.79635558e-02],\n        [-4.53882925e+00, -3.61320565e-01,  9.88348282e-02, ...,\n         -9.99270161e-02, -1.89315409e-01,  7.27320120e-02]],\n\n       [[-5.32383745e+00, -2.59905275e-01, -9.42536151e-02, ...,\n         -1.14359197e-01, -7.32243057e-02, -1.17779599e-01],\n        [-4.61458548e+00, -3.59844762e-01,  1.96055190e-01, ...,\n         -9.51545225e-02, -2.07306574e-01, -1.21820868e-01],\n        [-4.43024026e+00, -1.50307160e-01, -2.68508102e-01, ...,\n          2.49489361e-02, -2.64294322e-01, -1.70129536e-02],\n        ...,\n        [-1.79788969e+00, -4.62374302e-01,  3.78449074e-02, ...,\n         -1.45970427e-01, -1.10146726e-01, -3.16941288e-02],\n        [-1.89689242e+00,  1.96203432e-01,  1.83354633e-02, ...,\n         -1.92172321e-01,  7.78421414e-02, -5.74109845e-02],\n        [-4.11928259e+00, -7.79838400e-01, -1.65173175e-01, ...,\n          1.25174990e-01, -2.02087485e-01, -2.00104178e-02]]],\n      shape=(112, 112, 64))</pre></div></div></li><li class='xr-section-item'><input id='section-8967406f-f097-4f92-9a4b-a0483b4d1058' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8967406f-f097-4f92-9a4b-a0483b4d1058' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>48.0 47.99 47.98 ... 47.02 47.01</div><input id='attrs-f86a625d-1c93-4956-8828-ad38d82de45d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f86a625d-1c93-4956-8828-ad38d82de45d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10a0566a-4f81-4122-a639-4929d0917078' class='xr-var-data-in' type='checkbox'><label for='data-10a0566a-4f81-4122-a639-4929d0917078' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([47.997778, 47.988889, 47.98    , 47.971111, 47.962222, 47.953333,\n       47.944444, 47.935556, 47.926667, 47.917778, 47.908889, 47.9     ,\n       47.891111, 47.882222, 47.873333, 47.864444, 47.855556, 47.846667,\n       47.837778, 47.828889, 47.82    , 47.811111, 47.802222, 47.793333,\n       47.784444, 47.775556, 47.766667, 47.757778, 47.748889, 47.74    ,\n       47.731111, 47.722222, 47.713333, 47.704444, 47.695556, 47.686667,\n       47.677778, 47.668889, 47.66    , 47.651111, 47.642222, 47.633333,\n       47.624444, 47.615556, 47.606667, 47.597778, 47.588889, 47.58    ,\n       47.571111, 47.562222, 47.553333, 47.544444, 47.535556, 47.526667,\n       47.517778, 47.508889, 47.5     , 47.491111, 47.482222, 47.473333,\n       47.464444, 47.455556, 47.446667, 47.437778, 47.428889, 47.42    ,\n       47.411111, 47.402222, 47.393333, 47.384444, 47.375556, 47.366667,\n       47.357778, 47.348889, 47.34    , 47.331111, 47.322222, 47.313333,\n       47.304444, 47.295556, 47.286667, 47.277778, 47.268889, 47.26    ,\n       47.251111, 47.242222, 47.233333, 47.224444, 47.215556, 47.206667,\n       47.197778, 47.188889, 47.18    , 47.171111, 47.162222, 47.153333,\n       47.144444, 47.135556, 47.126667, 47.117778, 47.108889, 47.1     ,\n       47.091111, 47.082222, 47.073333, 47.064444, 47.055556, 47.046667,\n       47.037778, 47.028889, 47.02    , 47.011111])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-124.0 -124.0 ... -123.0 -123.0</div><input id='attrs-03f0abd7-85b8-47b5-993d-0c54987d7073' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-03f0abd7-85b8-47b5-993d-0c54987d7073' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-450a396f-a60d-4f9a-913b-e087fe69c276' class='xr-var-data-in' type='checkbox'><label for='data-450a396f-a60d-4f9a-913b-e087fe69c276' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-123.997778, -123.988889, -123.98    , -123.971111, -123.962222,\n       -123.953333, -123.944444, -123.935556, -123.926667, -123.917778,\n       -123.908889, -123.9     , -123.891111, -123.882222, -123.873333,\n       -123.864444, -123.855556, -123.846667, -123.837778, -123.828889,\n       -123.82    , -123.811111, -123.802222, -123.793333, -123.784444,\n       -123.775556, -123.766667, -123.757778, -123.748889, -123.74    ,\n       -123.731111, -123.722222, -123.713333, -123.704444, -123.695556,\n       -123.686667, -123.677778, -123.668889, -123.66    , -123.651111,\n       -123.642222, -123.633333, -123.624444, -123.615556, -123.606667,\n       -123.597778, -123.588889, -123.58    , -123.571111, -123.562222,\n       -123.553333, -123.544444, -123.535556, -123.526667, -123.517778,\n       -123.508889, -123.5     , -123.491111, -123.482222, -123.473333,\n       -123.464444, -123.455556, -123.446667, -123.437778, -123.428889,\n       -123.42    , -123.411111, -123.402222, -123.393333, -123.384444,\n       -123.375556, -123.366667, -123.357778, -123.348889, -123.34    ,\n       -123.331111, -123.322222, -123.313333, -123.304444, -123.295556,\n       -123.286667, -123.277778, -123.268889, -123.26    , -123.251111,\n       -123.242222, -123.233333, -123.224444, -123.215556, -123.206667,\n       -123.197778, -123.188889, -123.18    , -123.171111, -123.162222,\n       -123.153333, -123.144444, -123.135556, -123.126667, -123.117778,\n       -123.108889, -123.1     , -123.091111, -123.082222, -123.073333,\n       -123.064444, -123.055556, -123.046667, -123.037778, -123.028889,\n       -123.02    , -123.011111])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-33b41720-26d7-4b19-be3d-537d82e2b795' class='xr-section-summary-in' type='checkbox'  ><label for='section-33b41720-26d7-4b19-be3d-537d82e2b795' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d809a958-3fa4-4f15-80ea-2b77718540f3' class='xr-index-data-in' type='checkbox'/><label for='index-d809a958-3fa4-4f15-80ea-2b77718540f3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([47.997777777777785, 47.988888888888894, 47.980000000000004,\n        47.97111111111112,  47.96222222222223,  47.95333333333334,\n        47.94444444444445,  47.93555555555556,  47.92666666666668,\n       47.917777777777786,\n       ...\n        47.09111111111112,  47.08222222222223,  47.07333333333334,\n       47.064444444444455, 47.055555555555564, 47.046666666666674,\n       47.037777777777784,  47.02888888888889,  47.02000000000001,\n        47.01111111111112],\n      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=112))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d71bc5f4-6f18-4500-8895-c58a8da8a24d' class='xr-index-data-in' type='checkbox'/><label for='index-d71bc5f4-6f18-4500-8895-c58a8da8a24d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -123.9977777777779, -123.98888888888901, -123.98000000000012,\n       -123.97111111111123, -123.96222222222234, -123.95333333333345,\n       -123.94444444444457, -123.93555555555568, -123.92666666666679,\n        -123.9177777777779,\n       ...\n       -123.09111111111122, -123.08222222222233, -123.07333333333344,\n       -123.06444444444455, -123.05555555555566, -123.04666666666678,\n       -123.03777777777789,   -123.028888888889, -123.02000000000011,\n       -123.01111111111122],\n      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=112))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-949a2c19-bd69-44af-bb7b-6d06e5d86f14' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-949a2c19-bd69-44af-bb7b-6d06e5d86f14' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"dclqvwXvm9"}],"key":"S4WpkupayV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that despite substantially re-arranging the input ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pilagjJ1pG"},{"type":"inlineCode","value":"DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a8vtkJE8gF"},{"type":"text","value":", we have retained the coordinate information at a resampled resolution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v2D1Zpl5sR"}],"key":"BSRM5ACrkA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we simply sum the output over the channel dimension, we see that the encoder clearly distinguishes between upland and lowland areas.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z2lRzUNCyM"}],"key":"yQFnqvkyEg"}],"key":"dYGcMLlrxk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"latent_dim_cube.sum(dim=\"channel\").plot.imshow()","key":"qVuZiQx38I"},{"type":"output","id":"8VkQkWZoMmp_stYZGwbg8","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"853d0c290ae2ec944913acb6a584ff0f","path":"/xbatcher-deep-learning/build/853d0c290ae2ec944913acb6a584ff0f.png"}}}],"key":"mYNz5TMAvv"}],"key":"DEeYAiwUr0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As a final demonstration of this workflow, let’s compute the cosine similarity of each of the below pixels with the latent encoding of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NcbpfKg2so"},{"type":"link","url":"https://en.wikipedia.org/wiki/Mount_Olympus_(Washington)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mt. Olympus","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FJQuYjJT1O"}],"urlSource":"https://en.wikipedia.org/wiki/Mount_Olympus_(Washington)","data":{"page":"Mount_Olympus_(Washington)","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"KidT3Ll26d"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B10r3oAHGe"}],"key":"RY3VP9i1b6"}],"key":"jAJ2a9cact"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"olympus = dict(x=-123.7066, y=47.7998)\nolympus_latent = latent_dim_cube.sel(**olympus, method=\"nearest\")\nolympus_latent","key":"IRma4k1sCO"},{"type":"output","id":"G2tAy0hTh5BM3-ne1JwpX","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"<xarray.DataArray (channel: 64)> Size: 512B\narray([ 3.05193448,  0.07984048, -0.19406716,  0.23198933, -0.28311083,\n        0.06425693, -0.41277254,  0.10719062,  0.21293048,  0.18220075,\n        0.02312008,  0.26989496, -3.81439401,  0.01594482,  0.21865739,\n        2.11210263, -0.34720822, -0.01163836,  0.0337085 , -0.14257216,\n       -2.99752761, -0.09423765,  0.09816827, -1.24537382, -2.30954931,\n       -0.71140406,  0.2917199 , -0.0769781 , -0.03020979, -0.22612203,\n       -2.74899594,  0.38115255, -0.82641506, -0.48060534,  0.07423552,\n       -0.33775832,  0.22184855,  0.06239392,  1.01446021,  0.05642529,\n        0.01650721,  1.78647155,  0.32631236, -0.45510718,  0.24257852,\n        0.43398264, -0.04324041,  0.19464324,  0.64706841, -0.03532742,\n       -0.28180135, -4.13436094,  3.57349098, -1.55306568, -4.02541322,\n       -0.01129879, -0.14259338,  0.12843601, -0.26321372, -0.1023512 ,\n       -3.86097112,  0.10304318,  0.17730129,  0.16089438])\nCoordinates:\n    y        float64 8B 47.8\n    x        float64 8B -123.7\nDimensions without coordinates: channel","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (channel: 64)&gt; Size: 512B\narray([ 3.05193448,  0.07984048, -0.19406716,  0.23198933, -0.28311083,\n        0.06425693, -0.41277254,  0.10719062,  0.21293048,  0.18220075,\n        0.02312008,  0.26989496, -3.81439401,  0.01594482,  0.21865739,\n        2.11210263, -0.34720822, -0.01163836,  0.0337085 , -0.14257216,\n       -2.99752761, -0.09423765,  0.09816827, -1.24537382, -2.30954931,\n       -0.71140406,  0.2917199 , -0.0769781 , -0.03020979, -0.22612203,\n       -2.74899594,  0.38115255, -0.82641506, -0.48060534,  0.07423552,\n       -0.33775832,  0.22184855,  0.06239392,  1.01446021,  0.05642529,\n        0.01650721,  1.78647155,  0.32631236, -0.45510718,  0.24257852,\n        0.43398264, -0.04324041,  0.19464324,  0.64706841, -0.03532742,\n       -0.28180135, -4.13436094,  3.57349098, -1.55306568, -4.02541322,\n       -0.01129879, -0.14259338,  0.12843601, -0.26321372, -0.1023512 ,\n       -3.86097112,  0.10304318,  0.17730129,  0.16089438])\nCoordinates:\n    y        float64 8B 47.8\n    x        float64 8B -123.7\nDimensions without coordinates: channel</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span>channel</span>: 64</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-94543c81-70f1-4b34-87c2-96eace92adf4' class='xr-array-in' type='checkbox' checked><label for='section-94543c81-70f1-4b34-87c2-96eace92adf4' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>3.052 0.07984 -0.1941 0.232 -0.2831 ... -3.861 0.103 0.1773 0.1609</span></div><div class='xr-array-data'><pre>array([ 3.05193448,  0.07984048, -0.19406716,  0.23198933, -0.28311083,\n        0.06425693, -0.41277254,  0.10719062,  0.21293048,  0.18220075,\n        0.02312008,  0.26989496, -3.81439401,  0.01594482,  0.21865739,\n        2.11210263, -0.34720822, -0.01163836,  0.0337085 , -0.14257216,\n       -2.99752761, -0.09423765,  0.09816827, -1.24537382, -2.30954931,\n       -0.71140406,  0.2917199 , -0.0769781 , -0.03020979, -0.22612203,\n       -2.74899594,  0.38115255, -0.82641506, -0.48060534,  0.07423552,\n       -0.33775832,  0.22184855,  0.06239392,  1.01446021,  0.05642529,\n        0.01650721,  1.78647155,  0.32631236, -0.45510718,  0.24257852,\n        0.43398264, -0.04324041,  0.19464324,  0.64706841, -0.03532742,\n       -0.28180135, -4.13436094,  3.57349098, -1.55306568, -4.02541322,\n       -0.01129879, -0.14259338,  0.12843601, -0.26321372, -0.1023512 ,\n       -3.86097112,  0.10304318,  0.17730129,  0.16089438])</pre></div></div></li><li class='xr-section-item'><input id='section-e8f3828f-8bb6-499c-9015-bd8b8abe0cda' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e8f3828f-8bb6-499c-9015-bd8b8abe0cda' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>y</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>47.8</div><input id='attrs-65a94f57-9c2b-4d8c-83b0-dd53eabcff36' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65a94f57-9c2b-4d8c-83b0-dd53eabcff36' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e93397c-e5ed-4ce0-ab75-6237e3ba03e2' class='xr-var-data-in' type='checkbox'><label for='data-8e93397c-e5ed-4ce0-ab75-6237e3ba03e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(47.80222222)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>x</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-123.7</div><input id='attrs-77a97b98-75f1-4a15-96fa-b5bc4d8834ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-77a97b98-75f1-4a15-96fa-b5bc4d8834ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8c38fdf-5a8c-4db7-bd84-59e88c6c8c7a' class='xr-var-data-in' type='checkbox'><label for='data-d8c38fdf-5a8c-4db7-bd84-59e88c6c8c7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-123.70444444)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1c0f23a9-ce4c-4b2a-a5ab-789d5655443a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1c0f23a9-ce4c-4b2a-a5ab-789d5655443a' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-3589a820-5126-4a8a-b0d8-693e508edc55' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3589a820-5126-4a8a-b0d8-693e508edc55' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"a5CcPEJ6yB"}],"key":"p8gO97xXgy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def numpy_cosine_similarity(x, y):\n    return np.dot(x, y)/(norm(x)*norm(y))","key":"sr0Vml3zmm"},{"type":"output","id":"tpRFNJxZBR1MGCEj7AQRZ","data":[],"key":"RdomGybc8w"}],"key":"ykJOKZZx3f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"olympus_similarity = xr.apply_ufunc(\n    numpy_cosine_similarity,\n    latent_dim_cube,\n    input_core_dims = [[\"channel\"]],\n    output_core_dims = [[]],\n    vectorize=True,\n    kwargs=dict(y=olympus_latent.data)\n)","key":"nSOlQO7tAB"},{"type":"output","id":"S-CCGcl6PEHcx4z_crATc","data":[],"key":"jtApz50z7q"}],"key":"i6BAhH09g4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"olympus_similarity.plot.imshow()\nplt.scatter(olympus[\"x\"], olympus[\"y\"], marker=\"*\", c=\"purple\", edgecolor=\"black\", s=200)\nplt.title(\"Cosine similarity with Mt. Olympus, WA\")\nplt.show()","key":"J8kQq2gaJ7"},{"type":"output","id":"JgAihgM4ue_Bf4R4ZWxFY","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"08aa1627c346270330becdbc6c6f0221","path":"/xbatcher-deep-learning/build/08aa1627c346270330becdbc6c6f0221.png"}}}],"key":"cIKHFpeFK4"}],"key":"Ch7qPv1P22"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similarly, we can identify foothills with similar topography to Grisdale, WA.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yxox7vEl0U"}],"key":"BUBFjL1JhN"}],"key":"iks7x6UYYE"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"grisdale = dict(y=47.356625678465925, x=-123.61183314426664)\ngrisdale_latent = latent_dim_cube.sel(**grisdale, method=\"nearest\")\n\ngrisdale_similarity = xr.apply_ufunc(\n    numpy_cosine_similarity,\n    latent_dim_cube,\n    input_core_dims = [[\"channel\"]],\n    output_core_dims = [[]],\n    vectorize=True,\n    kwargs=dict(y=grisdale_latent.data)\n)\n\ngrisdale_similarity.plot.imshow()\nplt.scatter(grisdale[\"x\"], grisdale[\"y\"], marker=\"*\", c=\"purple\", edgecolor=\"black\", s=200)\nplt.show()","key":"xbJLvTZSV1"},{"type":"output","id":"TSux_CXwgwIYr8rvEnkmw","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b12635968930f0c94989647d60b10198","path":"/xbatcher-deep-learning/build/b12635968930f0c94989647d60b10198.png"}}}],"key":"kxh3gJPv06"}],"key":"FrUBzT7Yni"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This result is admittedly very similar to if we had just selected elevation bands :)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DmnqiPPqLv"}],"key":"RzhTGB2m7q"}],"key":"H3FRh4vsJn"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AazU4ry4id"}],"key":"WicizOdLvr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IdGc9K4SnY"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"Y3CImjOqUe"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Our goal with this notebook has been to show how xbatcher supports linking ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fJj49pC8C4"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nvXUq70SLa"},{"type":"text","value":" objects with deep learning models, and with converting model output back into labeled ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wwKGumouTE"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"moO2QhTDvx"},{"type":"text","value":" objects. We have demonstrated two examples of reconstructing model output, both when tensor shape changes and when it does not.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xQuau8DeCJ"}],"key":"twQmz8X144"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"If you encounter any issues, please open an issue on the GitHub repository for this cookbook. Other feedback is welcome!","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WCb8sMKkLl"}],"key":"KiTrjz5dlM"}],"key":"aqvM98BJKo"}],"key":"eM84GbAIgl"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Infer model on array","url":"/notebooks/inference-testing","group":"Testing model inference"}}},"domain":"http://localhost:3000"}